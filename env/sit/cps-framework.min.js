"use strict";function RoleSupport(){var e=ManagerFactory.newInstance();this.env=AppContext.getEnvironment(),this.apiService=e.obtainBean("cps_context","apiService")}function ContextSupport(){this.env=AppContext.getEnvironment(),this.clearUploader=function(e,t){UploadUtil.clear(e,t)}}function ApiService(e,t,n,r){var o=ApiContext.getCRUD(),a={position:"top",sticky:!1,type:"warn"};this.post=function(e,t,n){n=n||{},angular.extend(n,{userToken:UserUtil.getToken()});var i=o.post(e,n,t,!1);return i.then(function(e){"2"==e.code?window.location=Constants.LOGIN_URL:"1"==e.code&&e.data&&(e.data.records&&0==e.data.records.length||e.data.pageDTO&&0==e.data.pageDTO.totalCount)&&"undefined"!=typeof t.showMessage&&1==t.showMessage&&r.set(MsgDefines.MSG_000_001,a)}),i},this.getDropDownList=function(e,t){t=t||{},angular.extend(t,{userToken:UserUtil.getToken()});var n=o.post(ApiDefines.DROP_DOWN_LIST,t,{entityDTO:{typeCode:e}},!1);return n},this.getDropDownListDefault=function(e,t,n){t=t||{},angular.extend(t,{userToken:n});var i=o.post(ApiDefines.DROP_DOWN_LIST,t,e,!1);return i.then(function(t){"2"==t.code?window.location=Constants.LOGIN_URL:"1"==t.code&&t.data&&(t.data.records&&0==t.data.records.length||t.data.pageDTO&&0==t.data.pageDTO.totalCount)&&"undefined"!=typeof e.showMessage&&1==e.showMessage&&r.set(MsgDefines.MSG_000_001,a)}),i},this.postDefault=function(e,t,n){n=n||{};var i=o.post(e,n,t,!1);return i.then(function(e){"2"==e.code?window.location=Constants.LOGIN_URL:"1"==e.code&&e.data&&(e.data.records&&0==e.data.records.length||e.data.pageDTO&&0==e.data.pageDTO.totalCount)&&"undefined"!=typeof t.showMessage&&1==t.showMessage&&r.set(MsgDefines.MSG_000_001,a)}),i},this.submitData=function(e,t,n,r){$.ajax({method:"POST",url:appConfig.apiPath+e+"?userToken="+UserUtil.getToken(),data:this.transformFormData(t),contentType:!1,processData:!1,dataType:"json"}).done(function(e){"function"==typeof r&&"undefined"!=typeof n?r.call(n,e):"0"==e.code})},this.transformFormData=function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return t}}function ComponentSupport(){}function AngularContainer(){}function Container(){}function ApiContext(){}function AppContext(){}function WebContext(){}function ManagerFactory(){}function AngularManager(){}function Manager(){}function BeanUtil(){}function InstanceUtil(){}function MixinUtil(){}function ReflectionUtil(){}function RequireJsUtil(){}function TypeofUtil(){}function UserUtil(){}ContextSupport.prototype.execute=function(){},ComponentSupport.prototype.context=function(e,t,n,r){},ComponentSupport.prototype.link=function(e,t,n,r){},ComponentSupport.prototype.compile=function(e,t,n){},AngularContainer.extend(Container),AngularContainer.startup=function(){if(appConfig){var e=appConfig.modules;if(e){for(var t in e){var n=e[t].name,r=e[t].requires;angular.module(n,r)}var o=e[t].security;if(o){var a=o.credentials,i=o.urlWhites[appConfig.environment]||[];i.push("self"),angular.module(n).config(["$sceDelegateProvider","$httpProvider",function(e,t){e.resourceUrlWhitelist(i),t.defaults.withCredentials=a}])}var c=appConfig.router;if(c){var n=c.moduleName;angular.module(n).config(["$stateProvider","$urlRouterProvider",function(e,t){var n=c.otherwise;n&&t.otherwise(n);var r=c.states;if(r&&0<r.length)for(var o in r)r[o].views?e.state(r[o].name,{url:r[o].url,templateUrl:r[o].templateUrl,views:r[o].views,params:{data:null}}):e.state(r[o].name,{url:r[o].url,templateUrl:r[o].templateUrl,params:{data:null}})}])}}}if(beanConfig){var u=beanConfig.beans;for(var t in u){var n=u[t].moduleName,s=u[t].name,l=u[t].clazz,p=WebContext.createBean(l,[]);angular.module(n).value(s,p)}}if(serviceConfig){var f=serviceConfig.services;for(var t in f){var n=f[t].moduleName,g=f[t].requires||[],d=f[t].name,m=f[t].clazz,v="return WebContext.createService("+m+", arguments);",C=new Function(g.join(","),v);g.push(C),angular.module(n).factory(d,g)}}if(filterConfig){var U=filterConfig.filters;for(var t in U){var n=U[t].moduleName,y=U[t].name,h=U[t].clazz,g=U[t].requires||[],v="return WebContext.createFilter("+h+", arguments).doFilter;",x=new Function(g.join(","),v);g.push(x),angular.module(n).factory(y,g)}}if(contextConfig){var w=contextConfig.contexts;if(w&&0<w.length)for(var t in w){var n=w[t].moduleName,M=w[t].controllerName,g=w[t].requires||[],T=w[t].clazz;if(M&&T){var v="var ctx = WebContext.createContext($scope, "+T+', Array.prototype.slice.call(arguments, 2));var element = angular.element(document.querySelector("[ng-controller*='+M+']"));var findParentScope;(findParentScope = function(prentElement) {\tif (prentElement.attr("ng-controller")) {\t\tctx.parentContext = prentElement.scope();\t} else {\t\tif (prentElement.parent()[0]) {\t\t\tfindParentScope(prentElement.parent());\t\t}\t}})(element.parent());var manager = ManagerFactory.newInstance();var filter = manager.getFilter();ctx.parseDate = function(ngModelExpression, format) {\tthis.$watch(ngModelExpression, function(newVal, oldVal) {\t\tif (newVal) {\t\t\tvar date = filter("date")(newVal, format || "yyyy-MM-dd");\t\t\t$parse(ngModelExpression).assign(this, date);\t\t}\t}.bind(this));};ctx.clearUploader = function(uploader, fileSelector) {\tUploaderUtil.clear(uploader, fileSelector);};ctx.execute();ctx.colseNgNotify();',S=new Function("$scope,$parse,"+g.join(",").replace(/\$scope,/g,"").replace(/,\$scope/g,""),v);g.push(S),angular.module(n).controller(M,["$scope","$parse"].concat(g))}}}if(componentConfig){var A=componentConfig.components;if(A&&0<A.length)for(var t in A){var R=A[t].name||"component",F=A[t].clazz,I=A[t].name,b=A[t].mode,O=A[t].scope||{},N=void 0!=A[t].share&&A[t].share,_=A[t].restrict||"E",q=A[t].priority||"0",E=void 0!=A[t].replace&&A[t].replace,k=void 0!=A[t].transclude&&A[t].transclude,P=A[t].template,D=A[t].templateUrl,$=A[t].require,g=A[t].requires||[];if(I&&F&&b){var v="";"link"==b?v+="var "+R+" = WebContext.createComponent("+F+", arguments);":"compile"==b&&(v+="var "+R+" = WebContext.createComponent("+F+", arguments);"),v+="return {restrict: '"+_+"',priority: '"+q+"',scope: "+O+",replace: "+E+",transclude:"+k+",",$&&(v+="require: '"+$+"',"),P?v+="template: '"+P+"',":D&&(v+="templateUrl: '"+D+"',"),N&&(v+="controller: function($scope, $element, $attrs, $transclude) {"+R+".context($scope, $element, $attrs, $transclude);},"),"link"==b?v+="link: function(scope, element, attrs, controller) {"+R+".link(scope, element, attrs, controller);}":"compile"==b&&(v+="compile: function(element, attrs, transclude) {"+R+".compile(element, attrs, transclude);}"),v+="};";var B=new Function(g.join(","),v);g.push(B),angular.module(n).directive(I,g)}}}},Container.startup=function(){},ApiContext.exception=!1,ApiContext.txCache=[],ApiContext.openTx=function(){},ApiContext.commitTx=function(){if(!ApiContext.exception)for(var e in ApiContext.txCache)ApiContext.txCache[e]()},ApiContext.getCRUD=function(){function e(e){var t=ManagerFactory.newInstance(),n=t.getCurrentScope();r.all([e.promise]).then(function(e){n.$$phase||n.$apply()}),this.success=function(t,n){e.resolve(t)},this.error=function(t,n){e.reject(t)}}var t=ManagerFactory.newInstance(),n=t.getApiResource(),r=t.getQ(),o=function(e){return 0>e.indexOf("http://")&&0>e.indexOf("https://")&&(e=AppContext.getApiPath()+e),e};return{get:function(t,a){var i=r.defer(),c=new e(i);return n(o(t),a||{}).get(c.success,c.error),i.promise},query:function(t,a){var i=r.defer(),c=new e(i);return n(o(t),a||{}).query(c.success,c.error),i.promise},post:function(t,a,i,c){var u=r.defer(),s=new e(u);return c?ApiContext.txCache.push(function(){n(o(t)).save(a||{},i||{},s.success,s.error)}):n(o(t)).save(a||{},i||{},s.success,s.error),u.promise},put:function(t,a,i,c){var u=r.defer(),s=new e(u);return c?ApiContext.txCache.push(function(){n(o(t),{},{put:{method:"PUT"}}).put(a||{},i||{},s.success,s.error)}):n(o(t),{},{put:{method:"PUT"}}).put(a||{},i||{},s.success,s.error),u.promise},"delete":function(t,a,i,c){var u=r.defer(),s=new e(u);return c?ApiContext.txCache.push(function(){n(o(t))["delete"](a||{},i||{},s.success,s.error)}):n(o(t))["delete"](a||{},i||{},s.success,s.error),u.promise}}},AppContext.CONTAINER={angular:"angular"},AppContext.getContainer=function(){return appConfig.container},AppContext.getEnvironment=function(){return appConfig.environment},AppContext.getApiPath=function(){return appConfig.apiPath},WebContext.createContext=function(e,t,n){var r=BeanUtil.newInstance(t,n,e);return r},WebContext.createService=function(e,t){var n=BeanUtil.newInstance(e,t);return n},WebContext.createFilter=function(e,t){var n=BeanUtil.newInstance(e,t);return n},WebContext.createBean=function(e,t){var n=BeanUtil.newInstance(e,t);return n},WebContext.createComponent=function(e,t){var n=BeanUtil.newInstance(e,t);return n},WebContext.setRequestParams=function(e,t){if(e&&t)for(var n in t)e[n]=t[n]},WebContext.setProxyRoles=function(e,t,n){if(t&&n)for(var r in n){var o=n[r].clazz;if(o){var a=n[r].name,i=n[r].parent;if(i&&window[i]&&(o=window[o],o&&(i=window[i],o.extend(i))),o&&(!t[a]||ReflectionUtil.isField(t,a))){var c=BeanUtil.newInstance(o),u=new InvocationHandler(c,ApiContext.openTx,ApiContext.commitTx);t[a]=Proxy.newProxyInstance([o],u)}}}},ManagerFactory.manager,ManagerFactory.newInstance=function(){return ManagerFactory.manager||AppContext.CONTAINER.angular==AppContext.getContainer()&&(ManagerFactory.manager=new AngularManager),ManagerFactory.manager},AngularManager.extend(Manager),AngularManager.prototype.obtainBean=function(e,t){var n=[];"string"==typeof e?n.push(e):n=e;var r=angular.injector(n).get(t);return r},AngularManager.prototype.obtainModule=function(e){return angular.module(e)},AngularManager.prototype.getApiResource=function(){return this.obtainBean("ngResource","$resource")},AngularManager.prototype.getQ=function(){return this.obtainBean("ng","$q")},AngularManager.prototype.getTimeout=function(){return this.obtainBean("ng","$timeout")},AngularManager.prototype.getRootScope=function(){return this.obtainBean("ng","$rootScope")},AngularManager.prototype.getCookieStore=function(){return this.obtainBean("ngCookies","$cookieStore")},AngularManager.prototype.getCurrentScope=function(){return angular.element(document.querySelector("[ng-controller]")).scope()},AngularManager.prototype.getModal=function(){return this.obtainBean("ui.bootstrap.modal","$modal")},AngularManager.prototype.getFilter=function(){return this.obtainBean("ng","$filter")},Manager.prototype.obtainBean=function(e,t){},Manager.prototype.obtainModule=function(e){};var HttpMessage={DB_ERROR:{code:"001",msg:"数据库错误"},NOT_FOUND_DATA:{code:"100",msg:"未找到指定数据"},NOT_UNIQUE_RECORD:{code:"101",msg:"记录不唯一"},RESPONSE_OK:{code:200,msg:"请求成功"},REQUEST_TIMEOUT:{code:408,msg:"请求超时"}},HttpStatus={CONTINUE:{code:100,msg:"客户端应当继续发送请求"},SWITCHING_PROTOCOLS:{code:101,msg:"服务器已经理解了客户端的请求"},PROCESSING:{code:102,msg:"扩展的状态码,代表处理将被继续执行"},OK:{code:200,msg:"请求已成功,请求所希望的响应头或数据体将随此响应返回"},CREATED:{code:201,msg:"请求已经被实现,而且有一个新的资源已经依据请求的需要而建立"},ACCEPTED:{code:202,msg:"服务器已接受请求,但尚未处理"},NON_AUTHORITATIVE_INFORMATION:{code:203,msg:"服务器已成功处理了请求,但返回的实体头部元信息不是在原始服务器上有效的确定集合,而是来自本地或者第三方的拷贝"},NO_CONTENT:{code:204,msg:"服务器成功处理了请求,但不需要返回任何实体内容,并且希望返回更新了的元信息"},RESET_CONTENT:{code:205,msg:"服务器成功处理了请求,且没有返回任何内容"},PARTIAL_CONTENT:{code:206,msg:"服务器已经成功处理了部分 GET请求"},MULTI_STATUS:{code:207,msg:"扩展的状态码,代表之后的消息体将是一个XML消息"},MULTIPLE_CHOICES:{code:300,msg:"被请求的资源有一系列可供选择的回馈信息,每个都有自己特定的地址和浏览器驱动的商议信息"},MOVED_PERMANENTLY:{code:301,msg:"被请求的资源已永久移动到新位置,并且将来任何对此资源的引用都应该使用本响应返回的若干个 URI 之一"}};BeanUtil.newInstance=function(e,t,n){if("string"==typeof e&&(e=window[e]),n)return e.apply(n,t||[]),n;var r={};return r.__proto__=e.prototype,e.apply(r,t||[]),r},BeanUtil.toGetter=function(e){return"get"+e.substring(0,1).toUpperCase()+e.substring(1)},BeanUtil.toSetter=function(e){return"set"+e.substring(0,1).toUpperCase()+e.substring(1)},BeanUtil.getProperties=function(e){var t=[];for(var n in e)0==n.indexOf("get")&&e[n]instanceof Function&&t.push(n.substring(3,4).toLowerCase()+n.substring(4));return t},BeanUtil.getClassName=function(e){var t=e.__proto__.constructor.toString();return t=t.replace(/function /,"").replace(/\([\s\S]*\) \{[\s\S]*\}/g,"")},InstanceUtil.isNotEmpty=function(e){var t=!1;if(!TypeofUtil.isArray(e))for(var n in e){t=!0;break}return t},MixinUtil.create=function(e,t){for(var n in t.prototype)e.prototype[n]||(e.prototype[n]=t.prototype[n])},ReflectionUtil.invokeClassMethod=function(e,t,n){var r=!1;if(e instanceof Function)for(var o in e.prototype)if(e.prototype[o]==t){e.prototype[o](n),r=!0;break}return r},ReflectionUtil.invokeInstanceMethod=function(e,t,n){var r=!1;if(e instanceof Object)for(var o in e)if(e[o]instanceof Function)if(t instanceof Function){if(e[o]==t){t.apply(e,n),r=!0;break}}else if(o==t){e[o](),r=!0;break}return r},ReflectionUtil.isMethod=function(e,t){if(e instanceof Object)for(var n in e)if(e[n]instanceof Function&&n==t)return!0;return!1},ReflectionUtil.isField=function(e,t){if(e instanceof Object)for(var n in e)if(!(e[n]instanceof Function)&&n==t)return!0;return!1},ReflectionUtil.getMethodNames=function(e){var t=[];if(!(e instanceof Function))for(var n in e)e[n]instanceof Function&&t.push(n);return t},ReflectionUtil.getMethods=function(e){var t=[];if(!(e instanceof Function))for(var n in e)e[n]instanceof Function&&t.push(e[n]);return t},ReflectionUtil.getFieldNames=function(e){var t=[];if(!(e instanceof Function))for(var n in e)e[n]instanceof Function||t.push(n);return t},ReflectionUtil.getFields=function(e){var t=[];if(!(e instanceof Function))for(var n in e)e[n]instanceof Function||t.push(e[n]);return t},ReflectionUtil.getPublicMethodNames=function(e){var t=[];if("string"==typeof e&&(e=window[e]),e instanceof Function)for(var n in e.prototype)e.prototype[n]instanceof Function&&t.push(n);return t},ReflectionUtil.getPublicMethods=function(e){var t=[];if("string"==typeof e&&(e=window[e]),e instanceof Function)for(var n in e.prototype)e.prototype[n]instanceof Function&&t.push(e.prototype[n]);return t},ReflectionUtil.getPublicFieldNames=function(e){var t=[];if("string"==typeof e&&(e=window[e]),e instanceof Function)for(var n in e.prototype)e.prototype[n]instanceof Function||t.push(n);return t},ReflectionUtil.getPublicFields=function(e){var t=[];if("string"==typeof e&&(e=window[e]),e instanceof Function)for(var n in e.prototype)e.prototype[n]instanceof Function||t.push(e.prototype[n]);return t},RequireJsUtil.request,RequireJsUtil.createRequest=function(){try{RequireJsUtil.request=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{RequireJsUtil.request=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){RequireJsUtil.request=new XMLHttpRequest}}},RequireJsUtil.require=function(e){var t=requirejsConfig.paths,n="";for(var r in t)if(r==e){n=t[r];break}n&&(RequireJsUtil.createRequest(),RequireJsUtil.request.open("get",n,!1),RequireJsUtil.request.setRequestHeader("Content-Type","text/javascript"),RequireJsUtil.request.onreadystatechange=function(){4==RequireJsUtil.request.readyState&&200==RequireJsUtil.request.status},RequireJsUtil.request.send(null))},TypeofUtil.isJSON=function(e){return"object"==typeof e&&"[object object]"==Object.prototype.toString.call(e).toLowerCase()&&!e.length},TypeofUtil.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},TypeofUtil.isFunction=function(e){return e instanceof Function},TypeofUtil.isPlainObject=function(e){if(!e||"[object Object]"!==toString.call(e))return!1;if(e.constructor&&!hasOwnProperty.call(e,"constructor")&&!hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||hasOwnProperty.call(e,t)},UserUtil.saveLoginInfo=function(e){var t=ManagerFactory.newInstance(),n=t.getCookieStore();n.remove("current.loginInfo"),n.put("current.loginInfo",e)},UserUtil.getLoginInfo=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore();return t.get("current.loginInfo")},UserUtil.removeLoginInfo=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore();t.remove("current.loginInfo")},UserUtil.getUserId=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore(),n=t.get("current.loginInfo").id;return n?n.id:null},UserUtil.getUserRole=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore(),n=t.get("current.loginInfo");return n?n.role:null},UserUtil.saveToken=function(e){var t=ManagerFactory.newInstance(),n=t.getCookieStore();n.remove("current.userToken"),n.put("current.userToken",e)},UserUtil.getToken=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore();return t.get("current.userToken")},UserUtil.removeToken=function(){var e=ManagerFactory.newInstance(),t=e.getCookieStore();t.remove("current.userToken")},UserUtil.getGuide=function(e){var t=ManagerFactory.newInstance(),n=t.getCookieStore();return n.get(e)},UserUtil.setGuide=function(e){var t=ManagerFactory.newInstance(),n=t.getCookieStore();return n.put(e,"1")},UserUtil.saveMenus=function(e){localStorage.setItem("user_menus",e)},UserUtil.saveMenuBtn=function(e){localStorage.setItem("user_menus_btns",e)},UserUtil.checkHasMenu=function(e){var t=localStorage.getItem("user_menus");if(e&&""!=e&&t&&""!=t)for(var n=JSON.parse(t),r=0;r<n.length;r++)if(n[r].resCode==e)return!0;return!1},UserUtil.getViewAllProgram=function(e){var t={},n=localStorage.getItem("user_menus"),r=localStorage.getItem("user_menus_btns");if(e&&""!=e&&n&&r&&""!=r&&""!=n){var o=JSON.parse(r);o[e]&&o[e].forEach(function(e,n){t[e.resCode]=e})}return t};