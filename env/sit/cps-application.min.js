"use strict";function CheckLoginContext(e,t,i,s,n,o,a){this.execute=function(){this.validateUserInfo()},this.validateUserInfo=function(){var e=s.post(ApiDefines.VALIDATE_USER_INFO,{});e.then(function(e){"1"==e.code?this.getUserInfo():this.popAlert("用户信息过期,请重新登录.","error")}.bind(this))},this.getUserInfo=function(){var t=s.post(ApiDefines.GET_USER_INFO,angular.extend({}));t.then(function(t){"1"==t.code?(UserUtil.saveLoginInfo(t.data),e.go("main"),this.userInfo=t.data):this.popAlert("用户信息过期,请重新登录.","error")}.bind(this))},this.queryModel={},this.loginCPS=function(){e.go("main")},this.goSuccess=function(){e.go("main")},this.type=1,this.doSomething=function(){alert("query data")},this.doUpdate=function(){var e=s.post(ApiDefines.UPDATE_CUSTOMER,this.$parent.rowDetails);e.then(function(e){"0"==e.code&&(this.$parent.doPagingSearch(),this.popAlert(MsgDefines.MSG_007_002,"success"),this.closeModal())}.bind(this))},this.enBusLicenBackUpUploader=UploaderUtil.create(a,{url:appConfig.apiPath+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"0"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code&&(this.flag="1",this.popAlert("上传","success"))}.bind(this)}),this.doDelete=function(e){this.delConfirm.opened=!0,this.delConfirm.ok=function(){this.popAlert("delete done","success")}.bind(this)},this.delConfirm={opened:!1,ok:void 0,cancel:void 0},this.doSave=function(e){e&&alert("do save ok")}}function HomeContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.getAuditMenberNum=function(){var e=s.post(ApiDefines.AUDIT_MEMBER_NUMBER,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.auditMenberNum=e.data.count:this.popAlert(e.message,"error")}.bind(this))},this.goAuditMenberNum=function(){e.go("main.memberAudit");var t={name:"会员管理",sref:"main.memberAudit"};this.doActiveMenu(t)},this.getAuditMediaNum=function(){var e=s.post(ApiDefines.AUDIT_MEDIA_NUMBER,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.auditMediaNum=e.data.count:this.popAlert(e.message,"error")}.bind(this))},this.goAuditMediaNum=function(){e.go("main.mediaAudit");var t={name:"媒体管理",sref:"main.mediaAudit"};this.doActiveMenu(t)},this.getUnsendMessageNum=function(){var e=s.post(ApiDefines.UNSEND_MESSAGE_NUMBER,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.unsendMessageNum=e.data.count:this.popAlert(e.message,"error")}.bind(this))},this.goUnsendMessageNum=function(){e.go("main.messageList",{data:{status:"0"}});var t={name:"消息管理",sref:"main.messageList"};this.doActiveMenu(t)},this.getActivityCountNums=function(){var e=s.post(ApiDefines.ACTIVITY_COUNT_NUMBERS,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.todoSubmitNum=e.data.todoSubmitCount,this.todoApproveNum=e.data.todoApproveCount,this.todoModifyNum=e.data.todoModifyCount,this.pauseNum=e.data.pauseCount):this.popAlert(e.message,"error")}.bind(this))},this.goTodoSubmitNum=function(){e.go("main.adActiveList",{data:{status:"0"}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.goTodoApproveNum=function(){e.go("main.adActiveList",{data:{status:"1"}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.goTodoModifyNum=function(){e.go("main.adActiveList",{data:{status:"7"}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.goPauseNum=function(){e.go("main.adActiveList",{data:{status:"5"}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.getEncourageCountNums=function(){var e=s.post(ApiDefines.ENCOURAGE_COUNT_NUMBERS,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.waitApproveActiveEncourage=e.data.waitApproveActiveEncourage,this.waitApproveBaseEncourage=e.data.waitApproveBaseEncourage,this.waitModifyActiveEncourage=e.data.waitModifyActiveEncourage,this.waitModifyBaseEncourage=e.data.waitModifyBaseEncourage,this.waitSubmitActiveEncourage=e.data.waitSubmitActiveEncourage,this.waitSubmitBaseEncourage=e.data.waitSubmitBaseEncourage,this.stopBaseEncourage=e.data.stopBaseEncourage,this.stopActiveEncourage=e.data.stopActiveEncourage,this.waitBizApproveBaseActiveEncourage=e.data.waitBizApproveBaseActiveEncourage,this.waitBizApproveAmountActiveEncourage=e.data.waitBizApproveAmountActiveEncourage,this.waitFinApproveBaseActiveEncourage=e.data.waitFinApproveBaseActiveEncourage,this.waitFinApproveAmountActiveEncourage=e.data.waitFinApproveAmountActiveEncourage,this.waitBizApproveBaseEncourage=e.data.waitBizApproveBaseEncourage,this.waitFinApproveBaseEncourage=e.data.waitFinApproveBaseEncourage,this.waitSubmitbaseActiveEncourage=e.data.waitSubmitbaseActiveEncourage,this.waitSubmitrAmountActiveEncourage=e.data.waitSubmitrAmountActiveEncourage,this.waitModifyBaseActiveEncourage=e.data.waitModifyBaseActiveEncourage,this.waitModifyAmountActiveEncourage=e.data.waitModifyAmountActiveEncourage):this.popAlert(e.message,"error")}.bind(this))},this.goWaitApproveActiveEncourage=function(t,i){e.go("main.cpsActivityEncourageManage",{data:{status:i,type:t}});var s={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(s)},this.goWaitApproveBaseEncourage=function(t){e.go("main.cpsActivityEncourageManage",{data:{status:t,type:"1"}});this.doActiveMenu(waitApproveBaseEncourage)},this.goWaitModifyActiveEncourage=function(t){e.go("main.cpsActivityEncourageManage",{data:{status:"4",type:t}});var i={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(i)},this.goWaitModifyBaseEncourage=function(){e.go("main.cpsActivityEncourageManage",{data:{status:"4",type:"1"}});var t={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(t)},this.goWaitSubmitActiveEncourage=function(t){e.go("main.cpsActivityEncourageManage",{data:{status:"0",type:t}});var i={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(i)},this.goWaitSubmitBaseEncourage=function(){e.go("main.cpsActivityEncourageManage",{data:{status:"0",type:"1"}});var t={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(t)},this.goStopBaseEncourage=function(){e.go("main.cpsActivityEncourageManage",{data:{status:"7",type:"1"}});var t={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(t)},this.goStopActiveEncourage=function(){e.go("main.cpsActivityEncourageManage",{data:{status:"7",type:"2"}});var t={name:"推广管理",sref:"main.cpsActivityEncourageManage"};this.doActiveMenu(t)},this.getNotificationCountNums=function(){var e=s.post(ApiDefines.NOTICE_COUNT_NUMBERS,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.approveRefuse=e.data.approveRefuse,this.waitSubmit=e.data.waitSubmit,this.waitApprove=e.data.waitApprove,this.pause=e.data.pause):this.popAlert(e.message,"error")}.bind(this))},this.getSettlementsStatics=function(){var e=s.post(ApiDefines.SETTLESTATISTICS_COUNT_NUMBERS,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.settlementsStatics=e.data:this.popAlert(e.message,"error")}.bind(this))},this.paymentApplyStatics=function(){var e=s.post(ApiDefines.PAYMENTAPPLYSTATICS_COUNT_NUMBERS,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.paymentApplyStatics=e.data:this.popAlert(e.message,"error")}.bind(this))},this.goApproveRefuse=function(){e.go("main.notificationList",{data:{status:"2"}});var t={name:"推广管理",sref:"main.notificationList"};this.doActiveMenu(t)},this.goWaitSubmit=function(){e.go("main.notificationList",{data:{status:"0"}});var t={name:"推广管理",sref:"main.notificationList"};this.doActiveMenu(t)},this.goWaitApprove=function(){e.go("main.notificationList",{data:{status:"1"}});var t={name:"推广管理",sref:"main.notificationList"};this.doActiveMenu(t)},this.goPause=function(){e.go("main.notificationList",{data:{status:"6"}});var t={name:"推广管理",sref:"main.notificationList"};this.doActiveMenu(t)},this.goWaitBAudit=function(){e.go("main.memberBillQuery",{data:{status:"1"}});var t={name:"财务管理",sref:"main.memberBillQuery"};this.doActiveMenu(t)},this.goWaitFAudit=function(){e.go("main.memberBillQuery",{data:{status:"2"}});var t={name:"财务管理",sref:"main.memberBillQuery"};this.doActiveMenu(t)},this.goWaitUserConf=function(){e.go("main.memberBillQuery",{data:{status:"3"}});var t={name:"财务管理",sref:"main.memberBillQuery"};this.doActiveMenu(t)},this.goWaitAuditPay=function(){e.go("main.applyPurchase",{data:{status:"0"}});var t={name:"财务管理",sref:"main.applyPurchase"};this.doActiveMenu(t)},this.goWaitPay=function(){e.go("main.applyPurchase",{data:{status:"2"}});var t={name:"财务管理",sref:"main.applyPurchase"};this.doActiveMenu(t)},this.execute=function(){this.roleCode=UserUtil.getUserRole(),this.getAuditMenberNum(),this.getAuditMediaNum(),this.getUnsendMessageNum(),this.getActivityCountNums(),this.getEncourageCountNums(),this.getNotificationCountNums(),this.getSettlementsStatics(),this.paymentApplyStatics()}}function IndexContext(e,t,i,s,n,o){this.overflow={},this.queryModel={},this.alert={type:"warning",opened:!1,msg:""},this.succcessOption={position:"top",sticky:!1,type:"success"},this.infoOption={position:"top",sticky:!1,type:"info"},this.warnOption={position:"top",sticky:!1,type:"warn"},this.errorOption={position:"top",sticky:!1,type:"error",duration:5e3},this.execute=function(){o.set(Constants.FILE_SERVER_PATH,appConfig.apiPath,{exp:86400})},this.popAlert=function(e,t){t?"warning"==t?n.set(e,this.warnOption):"success"==t?n.set(e,this.succcessOption):"error"==t&&n.set(e,this.errorOption):n.set(e,this.infoOption)},this.ngNotify=function(e,t){t||n.set(e,this.infoOption),n.set(e,t)},this.colseNgNotify=function(){n.dismiss()},this.reset=function(){this.queryModel={entityDTO:{}}}}function MainContext(e,t,i,s,n){this.navLabel="",this.helpCount=24,this.msgCount=0,this.notice={show:!1,content:"",sref:""},this.menuInfoList=[],this.childMenuInfoList=[],this.activeMenu={},this.activeSubMenu={},this.userInfo={},this.userPortrait="",this.userName="",this.execute=function(){this.userInfo=UserUtil.getLoginInfo(),this.parentContext.overflow={overflow:"hidden"},this.menuInfoList=MenuData.getMemberMenus();var t=e.current.url;if("/main.html"==t)e.go("main.home"),this.activeMenu=this.menuInfoList[0];else{var i=t.split("/")[1].split(".")[0];"home"==i&&(i="memberList");for(var s in this.menuInfoList){if(i==this.menuInfoList[s].sref.split(".")[1]){this.activeMenu=this.menuInfoList[s];for(var n in this.menuInfoList[s].subMenuList)if(i==this.menuInfoList[s].subMenuList[n].sref.split(".")[1]){this.activeSubMenu=this.menuInfoList[s].subMenuList[n];break}break}for(var n in this.menuInfoList[s].subMenuList)for(var o in this.menuInfoList[s].subMenuList[n].subMenuList)if(i==this.menuInfoList[s].subMenuList[n].subMenuList[o].sref.split(".")[1]){this.activeMenu=this.menuInfoList[s],this.activeSubMenu=this.menuInfoList[s].subMenuList[n];break}}}},this.doActiveMenu=function(e){if(e.parent){for(var t in this.menuInfoList)if(e.parent==this.menuInfoList[t].name){this.activeMenu=this.menuInfoList[t];break}this.activeSubMenu=e}else{for(var t in this.menuInfoList)if(e.name==this.menuInfoList[t].name){this.activeMenu=this.menuInfoList[t];break}this.activeMenu.subMenuList&&0<this.activeMenu.subMenuList.length&&(this.activeSubMenu=this.activeMenu.subMenuList[0])}}.bind(this),this.openNotice=function(e,t){this.notice.show=!0,this.notice.content=e,this.notice.sref=t},this.closeNotice=function(){this.notice.show=!1,this.notice.content="",this.notice.sref=""},this.logout=function(){s.post(ApiDefines.LOGOUT);UserUtil.removeToken(),UserUtil.removeLoginInfo(),e.go("login")},this.getChildMenu=function(e){this.activeMenu=e}.bind(this),this.goHome=function(){e.go("main.home");var t={name:"会员管理",sref:"main.memberList"};this.doActiveMenu(t)},this.goMenberAudit=function(){e.go("main.memberAudit");var t={name:"会员管理",sref:"main.memberList"};this.doActiveMenu(t)},this.goMenberList=function(){e.go("main.memberList");var t={name:"会员管理",sref:"main.memberList"};this.doActiveMenu(t)}}function RoleSelectContext(e,t,i,s){this.queryModel={entityDTO:{}},this.execute=function(){this.queryModel.entityDTO.activityType="OS"},this.doSaveRole=function(){var t=s.post(ApiDefines.SELECT_ROLE+this.queryModel.entityDTO.activityType,angular.extend({}));t.then(function(t){"1"==t.code?e.go("checkLogin"):this.popAlert(t.message,"error")}.bind(this))}}function ConfigManagementContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,n={entityDTO:{typeCode:e}};return s.post(i,n).then(function(e){t.resolve(e.data)}.bind(this)),t}.bind(this),this.getTypeCodeArr=function(){this.typecodeArr=webStorageCache.get(DropDownListDefines.SETTLEMENT_STATUS),this.typecodeArr||this.getDictionarys(DropDownListDefines.SETTLEMENT_STATUS).then(function(e){this.typecodeArr=e,webStorageCache.set(DropDownListDefines.SETTLEMENT_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this))}.bind(this),this.execute=function(){this.getSystemSettings()},this.createConfig=function(){e.go("main.createConfig");var t={name:"配置管理",sref:"main.myIncome"};this.doActiveMenu(t)},this.editConfig=function(t){e.go("main.editConfig",{data:{configInfo:t}});var i={name:"配置管理",sref:"main.myIncome"};this.doActiveMenu(i)},this.deleteConfigConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteConfig=function(e){this.deleteConfigConfirm.opened=!0,this.deleteConfigConfirm.ok=function(){var t=ApiDefines.SYSTEM_CONFIG_DELETE,i={entityDTO:{dictionaryId:e.dictionaryId}};s.post(t,i).then(function(e){1==e.code?this.popAlert(e.message,"success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.getSystemSettings=function(){var e=s.post(ApiDefines.SYSTEM_INFO,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.queryModel.entityDTO.marketingUrlInfo=e.data.marketingUrlInfo,this.queryModel.entityDTO.operationUrlInfo=e.data.operationUrlInfo,this.queryModel.entityDTO.systemEmail=e.data.systemEmail,this.queryModel.entityDTO.systemEmailPassword=e.data.systemEmailPassword,this.queryModel.entityDTO.systemEmailName=e.data.systemEmailName,this.queryModel.entityDTO.customerServiceEmail=e.data.customerServiceEmail,this.queryModel.entityDTO.repertoryEmail=e.data.repertoryEmail,this.queryModel.entityDTO.maintainEmail=e.data.maintainEmail,this.queryModel.entityDTO.smtphost=e.data.smtphost,this.queryModel.entityDTO.port=e.data.port,this.queryModel.entityDTO.tls=e.data.tls,this.queryModel.entityDTO.emailQueueRetainTime=e.data.emailQueueRetainTime,this.queryModel.entityDTO.threadPoolMaxAmount=e.data.threadPoolMaxAmount,this.queryModel.entityDTO.threadPoolMinAmount=e.data.threadPoolMinAmount,this.queryModel.entityDTO.threadIdleSurvivalTime=e.data.threadIdleSurvivalTime,this.queryModel.entityDTO.rdValidDate=e.data.rdValidDate):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.updateSystemInfo=function(){var e=s.post(ApiDefines.UPDATE_SYSTEM_INFO,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.popAlert("配置项修改成功","success"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.configManagement");var t={name:"配置项管理",sref:"main.configManagement"};this.doActiveMenu(t)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.SYSTEM_CONFIG_QUERY,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);s.post(i,n).then(function(e){1==e.code?(this.searchedConfigList=e.data.records,this.totalPages=e.data.pageDTO.totalCount,this.pageIndex=e.data.pageDTO.pageNo):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}}}function CreateConfigContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.execute=function(){},this.addConfig=function(){var e=ApiDefines.SYSTEM_CONFIG_CREATE;this.queryModel.entityDTO.typeCode="SYSTEM";var t=this.queryModel;s.post(e,t).then(function(e){1==e.code?this.popAlert(e.message,"success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.back=function(){e.go("main.configManagement")}}function EditeConfigContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.execute=function(){t.data&&o.set("configInfo",t.data.configInfo,{exp:86400}),this.queryModel.entityDTO=o.get("configInfo")},this.editeConfig=function(){var e=ApiDefines.SYSTEM_CONFIG_EDITE,t=this.queryModel;n.post(e,t).then(function(e){1==e.code?this.popAlert(e.message,"success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.back=function(){e.go("main.configManagement")}}function ActivityEncourageAddContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.productRange=0,this.auditHis=0,this.queryModel.entityDTO.amountRuleList=[],this.amountRuleList=[{amountMin:"amountMin0",encourageRatio:"encourageRatio0"}],this.addEncourageList=function(){if(!(this.amountRuleList.length>=5)){var e=this.amountRuleList.length-1,t=parseInt(this.amountRuleList[e].amountMin.split("amountMin")[1])+1;this.amountRuleList.push({amountMin:"amountMin"+t,encourageRatio:"encourageRatio"+t})}},this.deleteEncourageList=function(e){this.amountRuleList.splice(e,1),this.queryModel.entityDTO.amountRuleList.splice(e,1)},this.changeEncourageType=function(e){this.queryModel.entityDTO.encourageType=e},this.activityEncourageUploader=UploaderUtil.create(n,{url:a.get(Constants.FILE_SERVER_PATH)+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.queryModel.entityDTO.approveAnnexUrl=e.fileUrl,this.queryModel.entityDTO.fileName=e.originalFileName,this.isTmpFile=!0,this.showDeleteFlag=!0):this.popAlert(e.message,"error")}.bind(this)}),this.removeFile=function(e){this.deleteFlag=!0,this.showDeleteFlag=!1,this.queryModel.entityDTO.approveAnnexUrl=null,this.clearUploader(this.activityEncourageUploader,"input[uploader=activityEncourageUploader]")},this.execute=function(){this.generateCPSNo(),this.queryModel.entityDTO.encourageMethod=0,this.queryModel.entityDTO.encourageType=2,this.queryModel.entityDTO.suitableRangeProduct=1},this.generateCPSNo=function(){var e=s.post(ApiDefines.CPS_NO_GET,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.queryModel.entityDTO.ruleId=e.data.cpstypeId:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsActivityEncourageManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.selectedProductArray=[],this.selectProduct=function(){this.product=ModalUtil.createModal(o,ModalPath.SELECT_PRODUCT,this,"lg")},this.removeProductList=function(e){var t=this.selectedProductArray.indexOf(e);t!=-1&&this.selectedProductArray.splice(t,1)},this.clearSelectedProduct=function(){this.selectedProductArray=[]},this.selectedCPSTypeArray=[],this.selectedCPSType=function(){this.productCPS=ModalUtil.createModal(o,ModalPath.EDIT_PRODDUCT_CPS,this,"md")},this.removeCPSTypeList=function(e){var t=this.selectedCPSTypeArray.indexOf(e);t!=-1&&this.selectedCPSTypeArray.splice(t,1)},this.clearSelectedCPSType=function(){this.selectedCPSTypeArray=[]},this.saveEncourage=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.productIdList=this.selectedProductArray,this.queryModel.entityDTO.cpstypeIdList=this.selectedCPSTypeArray;var t=s.post(ApiDefines.ENCOURAGE_ACTIVITY_ADD,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("添加成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.saveEncourageAndAudit=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.productIdList=this.selectedProductArray,this.queryModel.entityDTO.cpstypeIdList=this.selectedCPSTypeArray,this.queryModel.entityDTO.requestLocation=2;var t=s.post(ApiDefines.ENCOURAGE_ACTIVITY_ADD_AUDIT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("添加成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}function ActivityEncourageAuditContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.qeuryResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.encourageTypeDropList={},this.encourageStatusDropList={},this.encourageMethodDropList={},this.encourageScopeDropList={},this.auditResultDropList={},this.auditHis=0,this.submit=function(){var e="";e=1==o.get("auditType")?ApiDefines.BISSNESS_ENCOURAGE_AUDIT:ApiDefines.FINANCE_ENCOURAGE_AUDIT,this.queryModel.entityDTO.approveResult=1;var t=n.post(e,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("操作成功","success"),this.goBack()):this.popAlert(e.message,"error")}.bind(this))},this.noPassReason={opened:!1,ok:void 0,cancel:void 0},this.submitFalse=function(){this.noPassReason.opened=!0,this.noPassReason.ok=function(e){var t="";t=1==o.get("auditType")?ApiDefines.BISSNESS_ENCOURAGE_AUDIT:ApiDefines.FINANCE_ENCOURAGE_AUDIT,this.queryModel.entityDTO.approveResult=0,this.queryModel.entityDTO.remark=e;var i=n.post(t,angular.extend(this.queryModel));i.then(function(e){"1"==e.code?(this.popAlert("操作成功","success"),this.goBack()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.getEncourageFalseReasonDropList=function(){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_APPROVE_REMARK);e.then(function(e){"1"==e.code&&o.set("noPassAuditReasonArr",e.data,{exp:Constants.EXP_TIME})}.bind(this))}.bind(this),this.getEncourageScopeDropList=function(){if(this.encourageScopeDropList=o.get(DropDownListDefines.ENCOURAGE_SCOPE),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_SCOPE);e.then(function(e){"1"==e.code&&(this.encourageScopeDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_SCOPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageMethodDropList=function(){if(this.encourageMethodDropList=o.get(DropDownListDefines.ENCOURAGE_METHOD),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_METHOD);e.then(function(e){"1"==e.code&&(this.encourageMethodDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageStatusDropList=function(){if(this.encourageStatusDropList=o.get(DropDownListDefines.ENCOURAGE_RULE_STATUS),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_RULE_STATUS);e.then(function(e){"1"==e.code&&(this.encourageStatusDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_RULE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageTypeDropList=function(){if(this.encourageTypeDropList=o.get(DropDownListDefines.ENCOURAGE_TYPE),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_TYPE);e.then(function(e){"1"==e.code&&(this.encourageTypeDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAuditResultDropList=function(){if(this.auditResultDropList=o.get(DropDownListDefines.APPROVE_RESULT),!this.auditResultDropList){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,o.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getEncourageStatusDropList(),this.getEncourageTypeDropList(),this.getEncourageMethodDropList(),this.getEncourageScopeDropList(),this.getEncourageFalseReasonDropList(),this.getAuditResultDropList(),t.data&&(o.set("ruleId",t.data.ruleId,{exp:86400}),o.set("auditType",t.data.auditType,{exp:86400})),this.queryModel.entityDTO.ruleId=o.get("ruleId"),this.getDatail()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.GET_AUDIT_HIS_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},{entityDTO:{businessId:this.queryModel.entityDTO.ruleId}}));i.then(function(e){"1"==e.code?(this.queryAuditHisResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getDatail=function(){var e=n.post(ApiDefines.ENCOURAGE_ACTIVITY_DATAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.queryResult=e.data:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsActivityEncourageManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)}}function ActivityEncourageListContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.queryResult={},this.activityStatusDropListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.encourageTypeDropList={},this.encourageStatusDropList={},this.encourageMethodDropList={},this.hidden=!1,this.getEncourageMethodDropList=function(){if(this.encourageMethodDropList=a.get(DropDownListDefines.ENCOURAGE_METHOD),!this.encourageMethodDropList){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_METHOD);e.then(function(e){"1"==e.code&&(this.encourageMethodDropList=e.data,a.set(DropDownListDefines.ENCOURAGE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageStatusDropList=function(){if(this.encourageStatusDropList=a.get(DropDownListDefines.ENCOURAGE_RULE_STATUS),!this.encourageStatusDropList){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_RULE_STATUS);e.then(function(e){"1"==e.code&&(this.encourageStatusDropList=e.data,a.set(DropDownListDefines.ENCOURAGE_RULE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageTypeDropList=function(){if(this.encourageTypeDropList=a.get(DropDownListDefines.ENCOURAGE_TYPE),!this.encourageTypeDropList){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_TYPE);e.then(function(e){"1"==e.code&&(this.encourageTypeDropList=e.data,a.set(DropDownListDefines.ENCOURAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getEncourageStatusDropList(),this.getEncourageTypeDropList(),this.getEncourageMethodDropList(),this.roleCode=UserUtil.getUserRole(),t.data&&(this.queryModel.entityDTO.ruleStatus=t.data.status,this.queryModel.entityDTO.encourageType=t.data.type)},this.viewEncourage=function(t){e.go("main.cpsActivityEncourageView",{data:{ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.ENCOURAGE_ACTIVITY_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.addActivityEncourage=function(t){e.go("main.cpsActivityEncourageAdd");var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.submitAduitConfirm={opened:!1,ok:void 0,cancel:void 0},this.submitAduit=function(e){this.submitAduitConfirm.opened=!0,this.submitAduitConfirm.ok=function(){var t=n.post(ApiDefines.ENCOURAGE_SUBMIT_AUDIT,angular.extend({entityDTO:{ruleId:e}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("操作成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.goUpdateEncourage=function(t){e.go("main.cpsActivityEncourageUpdate",{data:{ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.goBusinessAudite=function(t){e.go("main.cpsActivityEncourageAudit",{data:{auditType:"1",ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.goFinanceAudite=function(t){e.go("main.cpsActivityEncourageAudit",{data:{auditType:"2",ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.deleteConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteEncourage=function(e){this.deleteConfirm.opened=!0,this.deleteConfirm.ok=function(){var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_DELETE,angular.extend({entityDTO:{ruleId:e}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.publishConfirm={opened:!1,ok:void 0,cancel:void 0},this.publishEncourage=function(e){this.publishConfirm.opened=!0,this.publishConfirm.ok=function(){var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_PUBULISH,angular.extend({entityDTO:{ruleId:e}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("发布成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.queryResult.length?this.checkedRows=[]:this.checkedRows=[].concat(this.queryResult)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)},this.reset=function(){this.queryModel={entityDTO:{}}}}function ActivityEncourageUpdateContext(e,t,i,s,n,o,a,r){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.showDeleteFlag=!0,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.activityEncourageUploader=UploaderUtil.create(o,{url:r.get(Constants.FILE_SERVER_PATH)+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.queryModel.entityDTO.approveAnnexUrl=e.fileUrl,this.queryModel.entityDTO.fileName=e.originalFileName):this.popAlert(e.message,"error")}.bind(this)}),this.removeFile=function(){this.queryModel.entityDTO.fileName="",this.queryModel.entityDTO.approveAnnexUrl=""},this.getAuditResultDropList=function(){if(this.auditResultDropList=r.get(DropDownListDefines.APPROVE_RESULT),!this.auditResultDropList){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,r.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getAuditResultDropList(),t.data&&r.set("ruleId",t.data.ruleId,{exp:86400}),this.queryModel.entityDTO.ruleId=r.get("ruleId"),this.getDatail()},this.saveEncourage=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.productIdList=this.selectedProductArray,this.queryModel.entityDTO.cpstypeIdList=this.selectedCPSTypeArray;var t=n.post(ApiDefines.ENCOURAGE_ACTIVITY_UPDATE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("修改成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.saveEncourageAndAudit=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.productIdList=this.selectedProductArray,this.queryModel.entityDTO.cpstypeIdList=this.selectedCPSTypeArray,this.queryModel.entityDTO.requestLocation=1;var t=n.post(ApiDefines.ENCOURAGE_ACTIVITY_ADD_AUDIT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("修改成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.getDatail=function(){var e=n.post(ApiDefines.ENCOURAGE_ACTIVITY_DATAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.queryModel.entityDTO=e.data,this.selectedCPSTypeArray=this.queryModel.entityDTO.cpstypeIdList,this.selectedProductArray=this.queryModel.entityDTO.productIdList,"undefined"==typeof this.queryModel.entityDTO.cpstypeIdList&&(this.selectedCPSTypeArray=[]),
"undefined"==typeof this.queryModel.entityDTO.productIdList&&(this.selectedProductArray=[]),this.productRange=this.queryModel.entityDTO.suitableRangeProduct):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsActivityEncourageManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.selectedProductArray=[],this.selectProduct=function(){this.product=ModalUtil.createModal(a,ModalPath.SELECT_PRODUCT,this,"lg")},this.removeProductList=function(e){var t=this.selectedProductArray.indexOf(e);t!=-1&&this.selectedProductArray.splice(t,1)},this.clearSelectedProduct=function(){this.selectedProductArray=[]},this.selectedCPSTypeArray=[],this.selectedCPSType=function(){this.productCPS=ModalUtil.createModal(a,ModalPath.EDIT_PRODDUCT_CPS,this,"md")},this.removeCPSTypeList=function(e){var t=this.selectedCPSTypeArray.indexOf(e);t!=-1&&this.selectedCPSTypeArray.splice(t,1)},this.clearSelectedCPSType=function(){this.selectedCPSTypeArray=[]},this.auditHis=0,this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.GET_AUDIT_HIS_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},{entityDTO:{businessId:this.queryModel.entityDTO.ruleId}}));i.then(function(e){"1"==e.code?(this.queryAuditHisResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.downloadfile=function(e,t){window.open(r.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_NORMRAL_DOWN+"?fileUrl="+e)}}function ActivityEncourageViewContext(e,t,i,s,n,o,a,r){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.showDeleteFlag=!0,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.getAuditResultDropList=function(){if(this.auditResultDropList=r.get(DropDownListDefines.APPROVE_RESULT),!this.auditResultDropList){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,r.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getAuditResultDropList(),t.data&&r.set("ruleId",t.data.ruleId,{exp:86400}),this.queryModel.entityDTO.ruleId=r.get("ruleId"),this.getDatail()},this.getDatail=function(){var e=n.post(ApiDefines.ENCOURAGE_ACTIVITY_DATAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?(this.queryModel.entityDTO=e.data,this.selectedCPSTypeArray=this.queryModel.entityDTO.cpstypeIdList,this.selectedProductArray=this.queryModel.entityDTO.productIdList,"undefined"==typeof this.queryModel.entityDTO.cpstypeIdList&&(this.selectedCPSTypeArray=[]),"undefined"==typeof this.queryModel.entityDTO.productIdList&&(this.selectedProductArray=[]),this.productRange=this.queryModel.entityDTO.suitableRangeProduct):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.downloadfile=function(e,t){window.open(r.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_NORMRAL_DOWN+"?fileUrl="+e)},this.goBack=function(){e.go("main.cpsActivityEncourageManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.auditHis=0,this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.GET_AUDIT_HIS_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},{entityDTO:{businessId:this.queryModel.entityDTO.ruleId}}));i.then(function(e){"1"==e.code?(this.queryAuditHisResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function AddProductContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.productStatusDropListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryProductListResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getProductStatus(),this.getCategory()},this.getCategory=function(){var e=ApiDefines.CPS_TYPE_LIST,t={entityDTO:{},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]};s.post(e,t).then(function(e){this.categoryArr=e.data.records}.bind(this))}.bind(this),this.saveProductList=function(){this.close()},this.resetProductType=function(){this.queryModel.entityDTO.productType=""},this.reset=function(){this.queryModel={entityDTO:{}}},this.checkAllRows=function(){if(this.selectedProductArray.length==this.queryProductListResult.length)this.selectedProductArray=[];else for(var e=0;e<this.queryProductListResult.length;e++)this.selectedProductArray.indexOf(this.queryProductListResult[e])==-1&&this.selectedProductArray.push(this.queryProductListResult[e])}.bind(this),this.checkRow=function(e){var t=this.selectedProductArray.indexOf(e);t!=-1?this.selectedProductArray.splice(t,1):this.selectedProductArray.push(e)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_PRODUCT_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryProductListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getProductStatus=function(){if(this.productStatusDropListResult=o.get(DropDownListDefines.PMS_SBOM_STATUS),!this.productStatusDropListResult){var e=s.getDropDownList(DropDownListDefines.PMS_SBOM_STATUS);e.then(function(e){"1"==e.code&&(this.productStatusDropListResult=e.data,o.set(DropDownListDefines.PMS_SBOM_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.selectProductBrand=function(){this.productBrand=ModalUtil.createModal(n,ModalPath.SELECT_PRODDUCT_BRAND,this,"md")},this.selectProductType=function(){this.productType=ModalUtil.createModal(n,ModalPath.SELECT_PRODDUCT_TYPE,this,"md")},this.editSelectedCPSType=function(){this.productCPS=ModalUtil.createModal(n,ModalPath.EDIT_PRODDUCT_CPS,this,"md")},this.editAllCPSType=function(){this.productCPS=ModalUtil.createModal(n,ModalPath.EDIT_PRODDUCT_CPS,this,"md")},this.close=function(){this.$close()}}function CPSProductListContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.updateModel={entityDTO:{}},this.productStatusDropListResult={},this.hidden=!1,this.queryResult={},this.salesChannelsDropListResult={},this.execute=function(){this.getSalesChannels(),this.getProductStatus(),this.getCategory()},this.getCategory=function(){var e=ApiDefines.CPS_TYPE_DROP_DOWN,t={};s.post(e,t).then(function(e){this.categoryArr=e.data}.bind(this))}.bind(this),this.getProductStatus=function(){if(this.productStatusDropListResult=o.get(DropDownListDefines.PMS_SBOM_STATUS),!this.productStatusDropListResult){var e=s.getDropDownList(DropDownListDefines.PMS_SBOM_STATUS);e.then(function(e){"1"==e.code&&(this.productStatusDropListResult=e.data,o.set(DropDownListDefines.PMS_SBOM_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getSalesChannels=function(){if(this.salesChannelsDropListResult=o.get(DropDownListDefines.PMS_SALE_CHANNEL_CODE),!this.salesChannelsDropListResult){var e=s.getDropDownList(DropDownListDefines.PMS_SALE_CHANNEL_CODE);e.then(function(e){"1"==e.code&&(this.salesChannelsDropListResult=e.data,o.set(DropDownListDefines.PMS_SALE_CHANNEL_CODE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.exportData=function(){var e=s.post(ApiDefines.CPS_PRODUCT_EXPORT,angular.extend({pageDTO:{pageSize:1e4,pageNo:1}},this.queryModel));e.then(function(e){"1"==e.code?window.open(o.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_DOWN+"?downFileName="+e.data.downFileName):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}},this.resetProductType=function(){this.queryModel.entityDTO.productType=""},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_PRODUCT_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.selectProductBrand=function(){this.productBrand=ModalUtil.createModal(n,ModalPath.SELECT_PRODDUCT_BRAND,this,"md")},this.selectProductType=function(){this.productType=ModalUtil.createModal(n,ModalPath.SELECT_PRODDUCT_TYPE,this,"md")},this.editSelectedCPSType=function(e){if(this.clearSelectedCPSType(),this.updateModel.entityDTO.productSkuList=[],e)this.updateModel.entityDTO.productSkuList.push({productSku:e.productSku,productName:e.productName});else{if(0==this.checkedRows.length)return this.popAlert("请选择一条商品记录","error"),!1;for(var t=0;t<this.checkedRows.length;t++)this.updateModel.entityDTO.productSkuList.push({productSku:this.checkedRows[t].productSku,productName:this.checkedRows[t].productName})}this.productCPS=ModalUtil.createModal(n,ModalPath.EDIT_PRODDUCT_CPS,this,"md"),this.productCPS.result.then(function(){var e=document.querySelector(".modal-dialog [ng-controller]"),t=angular.element(e),i=t.scope();if(0!=i.selectedCPSTypeArray.length){i.updateModel.entityDTO.cpstypeId=i.selectedCPSTypeArray[0].cpstypeId,i.updateModel.entityDTO.cpstypeName=i.selectedCPSTypeArray[0].cpstypeName;var n=s.post(ApiDefines.CPS_PRODUCT_UPDATR,angular.extend(i.updateModel));n.then(function(e){"1"==e.code?(i.popAlert("修改成功","success"),i.$parent.doPagingSearch(1)):i.popAlert(e.message,"error")}.bind(this))}})},this.editAllCPSType=function(){this.clearSelectedCPSType(),this.checkAllRows(),this.updateModel.entityDTO.productSkuList=[];for(var e=0;e<this.checkedRows.length;e++)this.updateModel.entityDTO.productSkuList.push({productSku:this.checkedRows[e].productSku,productName:this.checkedRows[e].productName});this.productCPS=ModalUtil.createModal(n,ModalPath.EDIT_PRODDUCT_CPS,this,"md"),this.productCPS.result.then(function(){var e=document.querySelector(".modal-dialog [ng-controller]"),t=angular.element(e),i=t.scope();if(0!=i.selectedCPSTypeArray.length){i.updateModel.entityDTO.cpstypeId=i.selectedCPSTypeArray[0].cpstypeId,i.updateModel.entityDTO.cpstypeName=i.selectedCPSTypeArray[0].cpstypeName;var n=s.post(ApiDefines.CPS_PRODUCT_UPDATR,angular.extend(i.updateModel));n.then(function(e){"1"==e.code?(i.popAlert("修改成功","success"),i.$parent.doPagingSearch(1)):i.popAlert(e.message,"error")}.bind(this))}}),this.checkedRows=[]},this.selectedCPSTypeArray=[],this.clearSelectedCPSType=function(){this.selectedCPSTypeArray=[]},this.delConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteSelectedCPSType=function(e){this.delConfirm.opened=!0,this.delConfirm.ok=function(){if(this.clearSelectedCPSType(),this.updateModel.entityDTO.productSkuList=[],e)this.updateModel.entityDTO.productSkuList.push({productSku:e.productSku,productName:e.productName});else{if(0==this.checkedRows.length)return this.popAlert("请选择一条商品记录","error"),!1;for(var t=0;t<this.checkedRows.length;t++)this.updateModel.entityDTO.productSkuList.push({productSku:this.checkedRows[t].productSku,productName:this.checkedRows[t].productName})}var i=s.post(ApiDefines.CPS_PRODUCT_DELETE,angular.extend(this.updateModel));i.then(function(e){"1"==e.code?(this.popAlert("删除成功","success"),this.doPagingSearch(1)):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.queryResult.length?this.checkedRows=[]:this.checkedRows=[].concat(this.queryResult)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)}}function CPSTypeActivityEncourageAddContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.activityEncourageUploader=UploaderUtil.create(o,{url:a.get(Constants.FILE_SERVER_PATH)+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["encourageFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.queryModel.entityDTO.approveAnnexUrl=e.fileUrl,this.queryModel.entityDTO.fileName=e.originalFileName,this.isTmpFile=!0,this.showDeleteFlag=!0):this.popAlert(e.message,"error")}.bind(this)}),this.removeFile=function(e){this.deleteFlag=!0,this.showDeleteFlag=!1,this.queryModel.entityDTO.approveAnnexUrl=null,this.clearUploader(this.activityEncourageUploader,"input[uploader=activityEncourageUploader]")},this.execute=function(){this.queryModel.entityDTO.encourageType=1,this.queryModel.entityDTO.encourageMethod=0,t.data&&(a.set("cpstypeId",t.data.cpstypeId,{exp:Constants.EXP_TIME}),a.set("cpstypeName",t.data.cpstypeName,{exp:Constants.EXP_TIME})),this.queryModel.entityDTO.cpstypeId=a.get("cpstypeId"),this.queryModel.entityDTO.cpstypeName=a.get("cpstypeName"),this.generateEncourageNo()},this.generateEncourageNo=function(){var e=n.post(ApiDefines.CPS_NO_GET,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.queryModel.entityDTO.ruleId=e.data.cpstypeId:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsTypeDetail",{data:{cpstypeId:this.queryModel.entityDTO.cpstypeId,cpstypeName:this.queryModel.entityDTO.cpstypeName}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.saveEncourage=function(e){if(this.sumbmited=!0,e){var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_ADD,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("添加成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.saveToAudit=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.requestLocation=2;var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_SUBMIT_AUDIT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("添加成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}function CPSTypeActivityEncourageUpdateContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.auditHis=0,this.auditResultDropList={},this.isTmpFile=!1,this.showDeleteFlag=!0,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.activityEncourageUploader=UploaderUtil.create(o,{url:a.get(Constants.FILE_SERVER_PATH)+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["encourageFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.queryModel.entityDTO.approveAnnexUrl=e.fileUrl,this.queryModel.entityDTO.fileName=e.originalFileName,this.isTmpFile=!0,this.showDeleteFlag=!0):this.popAlert(e.message,"error")}.bind(this)}),this.getAuditResultDropList=function(){if(this.auditResultDropList=a.get(DropDownListDefines.APPROVE_RESULT),!this.auditResultDropList){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,a.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getAuditResultDropList(),t.data&&(a.set("ruleId",t.data.ruleId,{exp:Constants.EXP_TIME}),a.set("cpstypeId",t.data.cpstypeId,{exp:Constants.EXP_TIME}),a.set("cpstypeName",t.data.cpstypeName,{exp:Constants.EXP_TIME})),this.queryModel.entityDTO.ruleId=a.get("ruleId"),this.queryEncourageDetail()}.bind(this),this.getAuditResultDropList=function(){if(this.auditResultDropList=a.get(DropDownListDefines.AUDIT_RESULT),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.AUDIT_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,a.set(DropDownListDefines.AUDIT_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.queryEncourageDetail=function(){var e=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_DETAIL,angular.extend({entityDTO:{ruleId:this.queryModel.entityDTO.ruleId}}));e.then(function(e){"1"==e.code?(this.queryModel.entityDTO=e.data.encourageRule,this.queryModel.entityDTO.cpstypeId=a.get("cpstypeId"),this.queryModel.entityDTO.cpstypeName=a.get("cpstypeName"),this.encourageRuleUpdateCustom=e.data.encourageRuleUpdateCustom,this.queryModel.entityDTO.approveAnnexUrl?this.showDeleteFlag=!0:this.showDeleteFlag=!1,"encourageRuleUpdateCustom"in e.data&&"updatedColumnList"in e.data.encourageRuleUpdateCustom&&(this.updatedColumnList=e.data.encourageRuleUpdateCustom.updatedColumnList)):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.checkColumnInList=function(e){var t=!1;if(this.updatedColumnList)for(var i=0;i<this.updatedColumnList.length;i++)if(this.updatedColumnList[i]==e){t=!0;break}return t},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.GET_AUDIT_HIS_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},{entityDTO:{businessId:this.queryModel.entityDTO.ruleId}}));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsTypeDetail",{data:{cpstypeId:this.queryModel.entityDTO.cpstypeId,cpstypeName:this.queryModel.entityDTO.cpstypeName}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.deleteFlag=!1,this.updateColumn=[],this.addColumnName=function(e){for(var t=!1,i=0;i<this.updateColumn.length;i++)if(this.updateColumn[i]==e){t=!0;break}0==t&&this.updateColumn.push(e)},this.saveEncourage=function(e){if(this.sumbmited=!0,e){this.deleteFlag&&(this.doRemoveFile(this.fileUrl),this.queryModel.entityDTO.approveAnnexUrl=null,this.queryModel.entityDTO.fileName=null),3==this.queryModel.entityDTO.ruleStatus&&(this.queryModel.entityDTO.updateColumnList=this.updateColumn);var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_UPDATE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("修改成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.saveToAudit=function(e){if(this.sumbmited=!0,e){this.deleteFlag&&(this.doRemoveFile(this.fileUrl),this.queryModel.entityDTO.approveAnnexUrl=null,this.queryModel.entityDTO.fileName=null),this.queryModel.entityDTO.requestLocation=1,3==this.queryModel.entityDTO.ruleStatus&&(this.queryModel.entityDTO.updateColumnList=this.updateColumn);var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_SUBMIT_AUDIT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("修改成功","success")):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.downloadfile=function(e){this.checkColumnInList(e)?window.open(a.get(Constants.FILE_SERVER_PATH)+"/"+this.queryModel.entityDTO.approveAnnexUrl):window.open(a.get(Constants.FILE_SERVER_PATH)+"/"+this.encourageRuleUpdateCustom.approveAnnexUrl)},this.removeFile=function(e){this.deleteFlag=!0,this.showDeleteFlag=!1,this.fileUrl=e},this.doRemoveFile=function(e){var t=n.post(a.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_DELETE,angular.extend({entityDTO:{isTmpFile:this.isTmpFile,fileUrl:e}}));t.then(function(e){"1"==e.code||this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function CPSTypeAddContext(e,t,i,s){this.queryModel={entityDTO:{}},this.execute=function(){this.generateCPSNo()},this.generateCPSNo=function(){var e=s.post(ApiDefines.CPS_NO_GET,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.queryModel.entityDTO.cpstypeId=e.data.cpstypeId:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.saveCPSType=function(e){if(this.sumbmited=!0,e){var t=s.post(ApiDefines.CPS_TYPE_ADD,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("添加成功","success")):this.popAlert(e.message,"error")}.bind(this))}},this.goBack=function(){e.go("main.cpsTypeManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)}}function CPSTypeDetailContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){t.data&&(o.set("cpstypeId",t.data.cpstypeId,{exp:Constants.EXP_TIME}),o.set("cpstypeName",t.data.cpstypeName,{exp:Constants.EXP_TIME})),this.queryModel.entityDTO.cpstypeId=o.get("cpstypeId"),this.queryModel.entityDTO.cpstypeName=o.get("cpstypeName"),this.getEncourageStatusDropList(),this.getEncourageTypeDropList(),this.getEncourageMethodDropList(),this.roleCode=UserUtil.getUserRole()},this.getEncourageMethodDropList=function(){if(this.encourageMethodDropList=o.get(DropDownListDefines.ENCOURAGE_METHOD),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_METHOD);e.then(function(e){"1"==e.code&&(this.encourageMethodDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageStatusDropList=function(){if(this.encourageStatusDropList=o.get(DropDownListDefines.ENCOURAGE_RULE_STATUS),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_RULE_STATUS);e.then(function(e){"1"==e.code&&(this.encourageStatusDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_RULE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageTypeDropList=function(){if(this.encourageTypeDropList=o.get(DropDownListDefines.ENCOURAGE_TYPE),!this.mediaTypeResult){var e=n.getDropDownList(DropDownListDefines.ENCOURAGE_TYPE);e.then(function(e){"1"==e.code&&(this.encourageTypeDropList=e.data,o.set(DropDownListDefines.ENCOURAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.CPS_TYPE_DETAIL,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.cpsTypeManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.goAddEncourage=function(){e.go("main.cpsTypeAddEncourage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.goUpdateEncourage=function(t){e.go("main.cpsTypeUpdateEncourage",{data:{cpstypeId:this.queryModel.entityDTO.cpstypeId,cpstypeName:this.queryModel.entityDTO.cpstypeName,ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.goViewEncourage=function(t){e.go("main.cpsTypeViewEncourage",{data:{cpstypeId:this.queryModel.entityDTO.cpstypeId,cpstypeName:this.queryModel.entityDTO.cpstypeName,ruleId:t.ruleId}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.submitAduitConfirm={opened:!1,ok:void 0,cancel:void 0},this.submitAduit=function(e){this.submitAduitConfirm.opened=!0,this.submitAduitConfirm.ok=function(){var t=n.post(ApiDefines.ENCOURAGE_SUBMIT_AUDIT,angular.extend({entityDTO:{ruleId:e}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("操作成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.businessAudite=function(e){this.entityDTO=e,this.approveStep=1,this.cpstypeName=this.queryModel.entityDTO.cpstypeName,this.productBrand=ModalUtil.createModal(a,ModalPath.CPS_TYPE_ENCOURAGE_AUDIT,this,"md")},this.financeAudite=function(e){this.approveStep=2,this.entityDTO=e,this.cpstypeName=this.queryModel.entityDTO.cpstypeName,this.productBrand=ModalUtil.createModal(a,ModalPath.CPS_TYPE_ENCOURAGE_AUDIT,this,"md")},this.deleteConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteEncourage=function(e){this.deleteConfirm.opened=!0,this.deleteConfirm.ok=function(){var t=ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_DELETE,i={entityDTO:{cpstypeId:e.cpstypeId,ruleId:e.ruleId}};n.post(t,i).then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.publishConfirm={opened:!1,ok:void 0,cancel:void 0},this.publishEncourage=function(e){this.publishConfirm.opened=!0,this.publishConfirm.ok=function(){var t=n.post(ApiDefines.CPS_TYPE_ENCOURAGE_ACTIVITY_PUBULISH,angular.extend({entityDTO:{ruleId:e}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("发布成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}}function CPSTypeEncourageAuditContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.approveResult=1,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.getAuditResultDropList=function(){if(this.auditResultDropList=n.get(DropDownListDefines.APPROVE_RESULT),!this.auditResultDropList){var e=s.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.auditResultDropList=e.data,n.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getAuditResultDropList(),1==this.$parent.approveStep?this.auditTitle="业务审核激励方案":this.auditTitle="财务审核激励方案",this.queryModel.entityDTO.ruleId=this.$parent.entityDTO.ruleId},this.view=function(){e.go("main.cpsTypeViewEncourage",{data:{cpstypeId:this.$parent.entityDTO.cpstypeId,cpstypeName:this.$parent.cpstypeName,ruleId:this.$parent.entityDTO.ruleId}});var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.submit=function(){var e="";e=1==this.$parent.approveStep?ApiDefines.BISSNESS_ENCOURAGE_AUDIT:ApiDefines.FINANCE_ENCOURAGE_AUDIT;var t=s.post(e,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("操作成功","success"),this.$parent.doPagingSearch(1),this.close()):this.popAlert(e.message,"error")}.bind(this))},this.close=function(){this.$close()}}function CPSTypeListContext(e,t,i,s){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_TYPE_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goCPSTypeAdd=function(){e.go("main.cpsTypeAdd");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.updateSelectedCPSType=function(t){e.go("main.cpsTypeUpdate",{data:{cpstypeId:t.cpstypeId,cpstypeName:t.cpstypeName}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.detailSelectedCPSType=function(t){e.go("main.cpsTypeDetail",{data:{cpstypeId:t.cpstypeId,cpstypeName:t.cpstypeName}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i,{data:{cpstypeId:t.cpstypeId,cpstypeName:t.cpstypeName}})},this.delConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteSelectedCPSType=function(e){this.delConfirm.opened=!0,this.delConfirm.ok=function(){this.queryModel.entityDTO.cpstypeId=e;var t=s.post(ApiDefines.CPS_TYPE_DELETE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除成功","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}}function CPSTypeUpdateContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.execute=function(){t.data&&(o.set("cpstypeId",t.data.cpstypeId,{exp:86400}),o.set("cpstypeName",t.data.cpstypeName,{exp:86400})),this.queryModel.entityDTO.cpstypeId=o.get("cpstypeId"),this.queryModel.entityDTO.cpstypeName=o.get("cpstypeName")},this.saveCPSType=function(e){if(this.sumbmited=!0,e){var t=n.post(ApiDefines.CPS_TYPE_UPDATE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.goBack(),this.popAlert("修改成功","success")):this.popAlert(e.message,"error")}.bind(this))}},this.goBack=function(){e.go("main.cpsTypeManage");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)}}function ProductBrandContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){},this.selectedProductBrand=function(e){for(var t=!1,i=0;i<this.selectedProductBrandArray.length;i++)if(this.selectedProductBrandArray[i].productbrandId==e.productbrandId){t=!0;break}0==t&&this.selectedProductBrandArray.push(e),this.close()},this.close=function(){this.$close()}}function ProductCPSContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){},this.selectedCPSType=function(e){for(var t=!1,i=0;i<this.selectedCPSTypeArray.length;i++)if(this.selectedCPSTypeArray[i].cpstypeId==e.cpstypeId){t=!0;break}0==t&&this.selectedCPSTypeArray.push(e),this.close()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_TYPE_SELECT_PAGE,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.cpstypeResultList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.close=function(){this.$close()}}function ProductTypeContext(e,t,i,s){this.queryPmsTypeListResult={},this.query={entityDTO:{}},this.execute=function(){this.doPagingSearch()},this.selectedProductType=function(e){this.queryModel.entityDTO.productType=e.name,this.close()},this.doPagingSearch=function(){"undefined"!=typeof index&&(this.pageIndex=index),"undefined"!=typeof pageSize&&(this.pageSize=pageSize);var e=s.post(ApiDefines.PMS_TYPE_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));e.then(function(e){"1"==e.code?this.queryPmsTypeListResult=e.data:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.close=function(){this.$close()}}function AccountQueryContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.ACCOUNT_QUERY,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);s.post(i,n).then(function(e){1==e.code?(this.searchedAccountList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}}}function ApplyPurchaseContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,s={entityDTO:{typeCode:e}};return n.post(i,s).then(function(e){if(1==e.code)t.resolve(e.data);else{var i=e.message;t.reject(i)}}.bind(this)),t}.bind(this),this.getApplyStatus=function(){this.applyStatusArr=o.get(DropDownListDefines.COMMISSION_APPLY_STATUS),this.applyStatusArr||this.getDictionarys(DropDownListDefines.COMMISSION_APPLY_STATUS).then(function(e){this.applyStatusArr=e,o.set(DropDownListDefines.COMMISSION_APPLY_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getIsNeedInvoice=function(){this.isNeedInvoiceArr=o.get(DropDownListDefines.IS_NEED_INVOICE),this.isNeedInvoiceArr||this.getDictionarys(DropDownListDefines.IS_NEED_INVOICE).then(function(e){
this.isNeedInvoiceArr=e,o.set(DropDownListDefines.IS_NEED_INVOICE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.execute=function(){this.getApplyStatus(),this.getIsNeedInvoice(),this.roleCode=UserUtil.getUserRole(),t.data&&(this.queryModel.entityDTO.status=t.data.status)},this.doPagingSearch=function(e,t){this.checkedRows=[],"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.APPLY_PURCHASE,s=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);void 0!=this.queryModel.entityDTO.createStartDate&&(this.queryModel.entityDTO.createStartDat=this.queryModel.entityDTO.createStartDat+" 00:00:00"),void 0!=this.queryModel.entityDTO.createEndDate&&(this.queryModel.entityDTO.createEndDate=this.queryModel.entityDTO.createEndDate+" 23:59:59"),n.post(i,s).then(function(e){void 0!=this.queryModel.entityDTO.createStartDate&&(this.queryModel.entityDTO.createStartDat=this.queryModel.entityDTO.createStartDat.split(" ")[0]),void 0!=this.queryModel.entityDTO.createEndDate&&(this.queryModel.entityDTO.createEndDate=this.queryModel.entityDTO.createEndDate.split(" ")[0]),1==e.code?(this.applyPurchaseList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.exports=function(){for(var e=[],t=0;t<this.checkedRows.length;t++)e.push(this.checkedRows[t].commissionApplyId);if(0==e.length)return void this.popAlert("请选择要导出的数据","warning");var i=ApiDefines.FINANCE_EXPORTS,s={entityDTO:{commissionApplyIds:e}};n.post(i,s).then(function(e){1==e.code?window.open(o.get("FILE_SERVER_PATH")+ApiDefines.FILE_DOWN+"?downFileName="+e.data.downFileName):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.applyPurchaseItendifyBatch=function(){for(var e=[],t=0;t<this.checkedRows.length;t++)2==this.checkedRows[t].status&&e.push(this.checkedRows[t].commissionApplyId);return 0==e.length?void this.popAlert("请选择可以进行确认已付款的数据","warning"):(this.applyPurchaseConfirm.opened=!0,void(this.applyPurchaseConfirm.ok=function(){var t=ApiDefines.FINANCE_PURCHASE_CONFIRM,i={entityDTO:{commissionApplyIds:e}};n.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)))}.bind(this),this.applyAuditBatch=function(e){for(var t=[],i=0;i<this.checkedRows.length;i++)0!=this.checkedRows[i].status&&1!=this.checkedRows[i].status||t.push(this.checkedRows[i].commissionApplyId);return 0==t.length?void this.popAlert("请选择可以进行审核的数据","warning"):(this.applyAuditConfirm.opened=!0,void(this.applyAuditConfirm.ok=function(e){if(void 0==e){var i=ApiDefines.FINANCE_APPLY_AUDIT,s={entityDTO:{commissionApplyIds:t,isPass:!0}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_APPLY_AUDIT,s={entityDTO:{commissionApplyIds:t,isPass:"false",remark:e}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)))}.bind(this),this.applyPurchaseConfirm={opened:!1,ok:void 0,cancel:void 0},this.applyPurchaseItendify=function(e){this.applyPurchaseConfirm.opened=!0,this.applyPurchaseConfirm.ok=function(){var t=ApiDefines.FINANCE_PURCHASE_CONFIRM,i={entityDTO:{commissionApplyIds:[e.commissionApplyId]}};n.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.applyAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.applyAudit=function(e){this.applyAuditConfirm.opened=!0,this.applyAuditConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_APPLY_AUDIT,s={entityDTO:{commissionApplyIds:[e.commissionApplyId],isPass:!0}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_APPLY_AUDIT,s={entityDTO:{commissionApplyIds:[e.commissionApplyId],isPass:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("审核操作已完成","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}.bind(this),this.reAudit=function(e){var t=n.post(ApiDefines.FINANCE_REAUDIT,angular.extend({entityDTO:{commissionApplyIds:[e.commissionApplyId]}}));t.then(function(e){"1"==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("重新审核操作已完成","success")):this.popAlert(e.message,"error")}.bind(this))},this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.applyPurchaseList.length?this.checkedRows=[]:this.checkedRows=[].concat(this.applyPurchaseList)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)},this.reset=function(){this.queryModel={entityDTO:{}}}}function ConfigItemContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.getMemberConfigItem=function(){var e=ApiDefines.FINANCE_CONFIG_ITEM_LIST,t={};s.post(e,t).then(function(e){1==e.code?this.queryModel.entityDTO=e.data:0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.execute=function(){this.getMemberConfigItem()},this.saveConfigItem=function(e){if(this.sumbmited=!0,e){var t=ApiDefines.FINANCE_CINFIG_ITEM_SAVE,i=this.queryModel;s.post(t,i).then(function(e){1==e.code?this.popAlert(e.message,"success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}}function MemberBillQueryContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,s={entityDTO:{typeCode:e}};return n.post(i,s).then(function(e){if(1==e.code)t.resolve(e.data);else{var i=e.message;t.reject(i)}}.bind(this)),t}.bind(this),this.getSetlementStatus=function(){this.setlementStatusArr=o.get(DropDownListDefines.SETTLEMENT_STATUS),this.setlementStatusArr||this.getDictionarys(DropDownListDefines.SETTLEMENT_STATUS).then(function(e){this.setlementStatusArr=e,o.set(DropDownListDefines.SETTLEMENT_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getEncourageType=function(){this.encourageTypeArr=o.get(DropDownListDefines.ENCOURAGE_TYPE),this.encourageTypeArr||this.getDictionarys(DropDownListDefines.ENCOURAGE_TYPE).then(function(e){this.encourageTypeArr=e,o.set(DropDownListDefines.ENCOURAGE_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getMediaStatus=function(){this.mediaStatusArr=o.get(DropDownListDefines.MEDIA_STATUS),this.mediaStatusArr||this.getDictionarys(DropDownListDefines.MEDIA_STATUS).then(function(e){this.mediaStatusArr=e,o.set(DropDownListDefines.MEDIA_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getAccountStatus=function(){this.accountStatusArr=o.get(DropDownListDefines.ACCOUNT_STATUS),this.accountStatusArr||this.getDictionarys(DropDownListDefines.ACCOUNT_STATUS).then(function(e){this.accountStatusArr=e,o.set(DropDownListDefines.ACCOUNT_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getCreateWay=function(){this.createWayArr=o.get(DropDownListDefines.ORDER_OBTAN_WAY),this.createWayArr||this.getDictionarys(DropDownListDefines.ORDER_OBTAN_WAY).then(function(e){this.createWayArr=e,o.set(DropDownListDefines.ORDER_OBTAN_WAY,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.execute=function(){this.getSetlementStatus(),this.getEncourageType(),this.getMediaStatus(),this.getAccountStatus(),this.getCreateWay(),this.roleCode=UserUtil.getUserRole(),t.data&&(this.queryModel.entityDTO.status=t.data.status)},this.viewSetlementDetail=function(t){e.go("main.memberSetlementDetail",{data:{billInfo:t,setlementStatusArr:this.setlementStatusArr,mediaStatusArr:this.mediaStatusArr,encourageTypeArr:this.encourageTypeArr}});var i={name:"财务管理",sref:"main.financeManagement"};this.doActiveMenu(i)},this.viewDailySummary=function(){e.go("main.memberDailySummary")},this.viewSubmitBusinessAudit=function(t){e.go("main.submitBusinessAudit",{data:{billInfo:t,setlementStatusArr:this.setlementStatusArr,mediaStatusArr:this.mediaStatusArr,encourageTypeArr:this.encourageTypeArr}});var i={name:"财务管理",sref:"main.financeManagement"};this.doActiveMenu(i)},this.businessAuditBatchConfirm={opened:!1,ok:void 0,cancel:void 0},this.businessAuditBatch=function(){for(var e=[],t=0;t<this.checkedRows.length;t++)1==this.checkedRows[t].status&&2==this.checkedRows[t].accountStatus&&4==this.checkedRows[t].mediaStatus&&e.push(this.checkedRows[t].settlementId);return 0==e.length?void this.popAlert("请选择可以进行业务审核的数据","warning"):(this.businessAuditBatchConfirm.opened=!0,void(this.businessAuditBatchConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_BUSINESS_AUDIT,s={entityDTO:{settlementIdList:e,isApproved:"true",remark:""}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_BUSINESS_AUDIT,s={entityDTO:{settlementIdList:e,isApproved:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)))}.bind(this),this.managerAuditBatchConfirm={opened:!1,ok:void 0,cancel:void 0},this.managerAuditBatch=function(){for(var e=[],t=0;t<this.checkedRows.length;t++)2==this.checkedRows[t].status&&2==this.checkedRows[t].accountStatus&&4==this.checkedRows[t].mediaStatus&&e.push(this.checkedRows[t].settlementId);return 0==e.length?void this.popAlert("请选择可以进行主管审核的数据","warning"):(this.managerAuditBatchConfirm.opened=!0,void(this.managerAuditBatchConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_MANAGER_AUDIT,s={entityDTO:{settlementIdList:e,isApproved:"true",remark:""}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_MANAGER_AUDIT,s={entityDTO:{settlementIdList:e,isApproved:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)))}.bind(this),this.businessAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.businessAudit=function(e){this.businessAuditConfirm.opened=!0,this.businessAuditConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_BUSINESS_AUDIT,s={entityDTO:{settlementIdList:[e.settlementId],isApproved:"true"}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_BUSINESS_AUDIT,s={entityDTO:{settlementIdList:[e.settlementId],isApproved:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}.bind(this),this.managerAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.managerAudit=function(e){this.managerAuditConfirm.opened=!0,this.managerAuditConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_MANAGER_AUDIT,s={entityDTO:{settlementIdList:[e.settlementId],isApproved:"true"}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_MANAGER_AUDIT,s={entityDTO:{settlementIdList:[e.settlementId],isApproved:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}.bind(this),this.userAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.userAudit=function(e){this.userAuditConfirm.opened=!0,this.userAuditConfirm.ok=function(t){if(void 0==t){var i=ApiDefines.FINANCE_USER_CONFIRM,s={entityDTO:{settlementId:e.settlementId,isConfirmed:"true",remark:""}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}else{var i=ApiDefines.FINANCE_USER_CONFIRM,s={entityDTO:{settlementId:e.settlementId,isConfirmed:"false",remark:t}};n.post(i,s).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("操作成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this)}.bind(this),this.doPagingSearch=function(e,t){this.checkedRows=[],"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEMBER_BILL_QUERY,s=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"status",type:"desc"},{propertyName:"type",type:"desc"}]},this.queryModel);void 0!=this.queryModel.entityDTO.createDateEnd&&(this.queryModel.entityDTO.createDateEnd=this.queryModel.entityDTO.createDateEnd+" 00:00:00"),void 0!=this.queryModel.entityDTO.createDateStart&&(this.queryModel.entityDTO.createDateStart=this.queryModel.entityDTO.createDateStart+" 23:59:59"),n.post(i,s).then(function(e){void 0!=this.queryModel.entityDTO.createDateEnd&&(this.queryModel.entityDTO.createDateEnd=this.queryModel.entityDTO.createDateEnd.split(" ")[0]),void 0!=this.queryModel.entityDTO.createDateStart&&(this.queryModel.entityDTO.createDateStart=this.queryModel.entityDTO.createDateStart.split(" ")[0]),1==e.code?(this.searchedMemberBillList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.searchedMemberBillList.length?this.checkedRows=[]:this.checkedRows=[].concat(this.searchedMemberBillList)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)},this.reset=function(){this.queryModel={entityDTO:{}}}}function MemberDailySummaryContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.advanced_query=!0,this.click_hidden=!1,this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,n={entityDTO:{typeCode:e}};return s.post(i,n).then(function(e){if(1==e.code)t.resolve(e.data);else{var i=e.message;t.reject(i)}}.bind(this)),t}.bind(this),this.getOrderStatus=function(){this.orderStatusArr=n.get(DropDownListDefines.ORDER_STATUS),this.orderStatusArr||this.getDictionarys(DropDownListDefines.ORDER_STATUS).then(function(e){this.orderStatusArr=e,n.set(DropDownListDefines.ORDER_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getEncougageType=function(){this.encourageTypeArr=n.get(DropDownListDefines.ENCOURAGE_TYPE),this.encourageTypeArr||this.getDictionarys(DropDownListDefines.ENCOURAGE_TYPE).then(function(e){this.encourageTypeArr=e,n.set(DropDownListDefines.ENCOURAGE_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getSettlementCondition=function(){this.settlementConditionArr=n.get(DropDownListDefines.SETTLEMENT_CONDITION),this.settlementConditionArr?this.queryModel.entityDTO.condition=this.settlementConditionArr[0].optionKey:this.getDictionarys(DropDownListDefines.SETTLEMENT_CONDITION).then(function(e){this.settlementConditionArr=e,this.queryModel.entityDTO.condition=e[0].optionKey,n.set(DropDownListDefines.SETTLEMENT_CONDITION,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getCategory=function(){var e=ApiDefines.CPS_TYPE_LIST,t={entityDTO:{},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]};s.post(e,t).then(function(e){this.categoryArr=e.data.records}.bind(this))}.bind(this),this.execute=function(){this.getOrderStatus(),this.getEncougageType(),this.getSettlementCondition(),this.getCategory()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEMBER_SETLLEMENT_DETAIL,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);void 0!=this.queryModel.entityDTO.settlementStartDate&&(this.queryModel.entityDTO.settlementStartDate=this.queryModel.entityDTO.settlementStartDate+" 00:00:00"),void 0!=this.queryModel.entityDTO.settlementEndDate&&(this.queryModel.entityDTO.settlementEndDate=this.queryModel.entityDTO.settlementEndDate+" 23:59:59"),s.post(i,n).then(function(e){void 0!=this.queryModel.entityDTO.settlementStartDate&&(this.queryModel.entityDTO.settlementStartDate=this.queryModel.entityDTO.settlementStartDate.split(" ")[0]),void 0!=this.queryModel.entityDTO.settlementEndDate&&(this.queryModel.entityDTO.settlementEndDate=this.queryModel.entityDTO.settlementEndDate.split(" ")[0]),1==e.code?(this.searchedMemberSetlementDetailList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.condition=this.settlementConditionArr[0].optionKey}}function MemberSetlementDetailContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.hidden=!1,this.execute=function(){t.data&&(o.set("billInfo",t.data.billInfo,{exp:86400}),o.set("setlementStatusArr",t.data.setlementStatusArr,{exp:86400}),o.set("mediaStatusArr",t.data.mediaStatusArr,{exp:86400}),o.set("encourageTypeArr",t.data.encourageTypeArr,{exp:86400})),this.billInfo=o.get("billInfo"),this.setlementStatusArr=o.get("setlementStatusArr"),this.mediaStatusArr=o.get("mediaStatusArr"),this.encourageTypeArr=o.get("encourageTypeArr")},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEMBER_SETLLEMENT_DETAIL_AUDIT,s={entityDTO:{businessId:this.billInfo.memberId},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"createTime",type:"desc"}]};n.post(i,s).then(function(e){1==e.code?(this.auditList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function SubmitBusinessAuditContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.hidden=!1,this.execute=function(){t.data&&(o.set("billInfo",t.data.billInfo,{exp:86400}),o.set("setlementStatusArr",t.data.setlementStatusArr,{exp:86400}),o.set("mediaStatusArr",t.data.mediaStatusArr,{exp:86400}),o.set("encourageTypeArr",t.data.encourageTypeArr,{exp:86400})),this.billInfo=o.get("billInfo"),this.setlementStatusArr=o.get("setlementStatusArr"),this.mediaStatusArr=o.get("mediaStatusArr"),this.encourageTypeArr=o.get("encourageTypeArr"),null!=this.billInfo.finalMoney&&""!=this.billInfo.finalMoney?this.finalMoney=this.billInfo.finalMoney:this.finalMoney=this.billInfo.statisticsMoney},this.submitBusinessAudit=function(t){if(""==t)return void this.popAlert("你必须输入实际结算金额","warning");var i=ApiDefines.FINANCE_SUBMIT_BUSINESS_AUDIT,s={entityDTO:{settlementId:this.billInfo.settlementId,finalMoney:t,remark:"重新提交业务审核，修改原因"}};n.post(i,s).then(function(t){1==t.code?(this.popAlert("审核操作成功","success"),e.go("main.memberBillQuery")):0==t.code?this.popAlert(t.message,"error"):this.popAlert(t.message,"error")}.bind(this))},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEMBER_SETLLEMENT_DETAIL_AUDIT,s={entityDTO:{businessId:this.billInfo.settlementId},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"createTime",type:"desc"}]};n.post(i,s).then(function(e){1==e.code?(this.auditList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function MediaAuditContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryModel={entityDTO:{}},this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,n={entityDTO:{typeCode:e}};return s.post(i,n).then(function(e){if(1==e.code)t.resolve(e.data);else{var i=e.message;t.reject(i)}}.bind(this)),t}.bind(this),this.getWebsiteType=function(){this.websiteTypeArr=n.get(DropDownListDefines.SITE_TYPE),this.websiteTypeResult||this.getDictionarys(DropDownListDefines.SITE_TYPE).then(function(e){this.websiteTypeArr=e,n.set(DropDownListDefines.SITE_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getMediaStatus=function(){this.mediaStatusArr=n.get(DropDownListDefines.MEDIA_STATUS),this.mediaStatusResult||this.getDictionarys(DropDownListDefines.MEDIA_STATUS).then(function(e){this.mediaStatusArr=e,n.set(DropDownListDefines.MEDIA_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getMediaType=function(){this.mediaTypeArr=n.get(DropDownListDefines.MEDIA_TYPE),this.mediaTypeResult||this.getDictionarys(DropDownListDefines.MEDIA_TYPE).then(function(e){this.mediaTypeArr=e,n.set(DropDownListDefines.MEDIA_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getIsUse=function(){this.isUseArr=n.get(DropDownListDefines.MEDIA_USE_STATUS),this.isUseResult||this.getDictionarys(DropDownListDefines.MEDIA_USE_STATUS).then(function(e){this.isUseArr=e,n.set(DropDownListDefines.MEDIA_USE_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.execute=function(){this.getWebsiteType(),this.getMediaStatus(),this.getMediaType(),this.getIsUse()},this.viewMediaAuditInfo=function(t){e.go("main.mediaAuditInfo",{data:{mediaAuditInfo:t,websiteTypeArr:this.websiteTypeArr,mediaStatusArr:this.mediaStatusArr,mediaTypeArr:this.mediaTypeArr,isUseArr:this.isUseArr}});var i={name:"媒体管理",sref:"main.mediaPromotion"};this.doActiveMenu(i)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEDIA_AUDIT_LIST,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);void 0!=n.entityDTO.endCreateDate&&(n.entityDTO.endCreateDate=n.entityDTO.endCreateDate+" 23:59:00"),void 0!=n.entityDTO.startCreateDate&&(n.entityDTO.startCreateDate=n.entityDTO.startCreateDate+" 00:00:00"),s.post(i,n).then(function(e){void 0!=n.entityDTO.endCreateDate&&(n.entityDTO.endCreateDate=n.entityDTO.endCreateDate.split(" ")[0]),void 0!=n.entityDTO.startCreateDate&&(n.entityDTO.startCreateDate=n.entityDTO.startCreateDate.split(" ")[0]),1==e.code?(this.searchedMediasAuditList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.searchedMediasAuditList.length?this.checkedRows=[]:this.checkedRows=[].concat(this.searchedMediasAuditList)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e.mediaId)},this.doResetMediaAudit=function(){this.queryModel={entityDTO:{}}}}function MediaAuditInfoContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.hidden=!1,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.auditInfo={},this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,s={entityDTO:{typeCode:e}};return n.post(i,s).then(function(e){t.resolve(e.data)}.bind(this)),t}.bind(this),this.getNoPassAuditReason=function(){this.getDictionarys(DropDownListDefines.MEDIA_APPROVE_REMARK).then(function(e){this.noPassAuditReasonArr=e,o.set("noPassAuditReasonArr",this.noPassAuditReasonArr,{exp:86400}),o.set(DropDownListDefines.MEDIA_APPROVE_REMARK,e,{exp:Constants.EXP_TIME})}.bind(this))}.bind(this),this.execute=function(){this.getNoPassAuditReason(),t.data&&(o.set("mediaAuditInfo",t.data.mediaAuditInfo,{exp:86400}),o.set("websiteTypeArr",t.data.websiteTypeArr,{exp:86400}),o.set("mediaStatusArr",t.data.mediaStatusArr,{exp:86400}),o.set("mediaTypeArr",t.data.mediaTypeArr,{exp:86400}),o.set("isUseArr",t.data.isUseArr,{exp:86400})),this.auditInfo=o.get("mediaAuditInfo"),this.memberId=this.auditInfo.memberId,this.websiteTypeArr=o.get("websiteTypeArr"),this.mediaStatusArr=o.get("mediaStatusArr"),this.mediaTypeArr=o.get("mediaTypeArr"),this.isUseArr=o.get("isUseArr"),this.getMediaDetail()},this.getMediaDetail=function(){var e=n.post(ApiDefines.MEDIA_DETAIL,angular.extend({entityDTO:{mediaId:this.auditInfo.mediaId}}));e.then(function(e){"1"==e.code&&(this.auditInfo=e.data)}.bind(this))}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEDIA_AUDIT_DETAIL,s={entityDTO:{businessId:this.auditInfo.mediaId},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"createTime",type:"desc"}]};n.post(i,s).then(function(e){1==e.code?(this.searchedMediasAuditList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.auditPass=function(e){var t=e.mediaId,i=ApiDefines.AUDIT_PASS_OR_NOPASS,s={entityDTO:{businessId:t,result:1}};n.post(i,s).then(function(e){1==e.code?this.popAlert("审核通过成功","success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))},this.noPassReason={opened:!1,ok:void 0,cancel:void 0},this.auditNoPass=function(e){this.noPassReason.opened=!0,this.noPassReason.ok=function(t){var i=e.mediaId,s=ApiDefines.AUDIT_PASS_OR_NOPASS,o={entityDTO:{businessId:i,result:0,remark:t}};n.post(s,o).then(function(e){1==e.code?this.popAlert("审核不通过成功","success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.goBack=function(){e.go("main.mediaAudit")}}function MediaBlackListContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.websiteDomain="",this.execute=function(){},this.createBlackMedia=function(){e.go("main.blackMedia");var t={name:"媒体管理",sref:"main.mediaPromotion"};this.doActiveMenu(t)},this.addBlackListManual=function(){var e=ApiDefines.ADD_BLACK_LIST_MANUAL,t={entityDTO:{websiteDomain:this.websiteDomain}};s.post(e,t).then(function(e){1==e.code?this.popAlert(e.message,"success"):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this),function(e){this.popAlert(e.statusText,"error")})}.bind(this),this.releaseConfirm={opened:!1,ok:void 0,cancel:void 0},this.repleaseBlackList=function(e){this.releaseConfirm.opened=!0,this.releaseConfirm.ok=function(){var t=ApiDefines.RELEASE_BLACK_LIST,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert(e.message,"success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this),function(e){this.popAlert(e,"error")})}.bind(this)}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.BLACK_LIST,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel);s.post(i,n).then(function(e){1==e.code?(this.searchedBlackList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.mediaBlackList")},this.cancel=function(){e.go("main.mediaBlackList")},this.resetBlackList=function(){this.queryModel={entityDTO:{}}}}function MediaInfoContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.hidden=!1,this.hidden_audit=!1,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.pageIndex_promotion=PageConfig.INIT_PAGE_INDEX,this.pageIndex_audit=PageConfig.INIT_PAGE_INDEX,this.aduit_totalCount=0,this.mediaInfo={},this.mediaDetailResult={},this.execute=function(){t.data&&(o.set("mediaInfo",t.data.mediaInfo,{exp:86400}),o.set("websiteTypeArr",t.data.websiteTypeArr,{exp:86400}),o.set("mediaStatusArr",t.data.mediaStatusArr,{exp:86400}),o.set("mediaTypeArr",t.data.mediaTypeArr,{exp:86400}),o.set("isUseArr",t.data.isUseArr,{exp:86400})),this.mediaInfo=o.get("mediaInfo"),this.queryModel.entityDTO.mediaId=this.mediaInfo.mediaId,this.websiteTypeArr=o.get("websiteTypeArr"),this.mediaStatusArr=o.get("mediaStatusArr"),this.mediaTypeArr=o.get("mediaTypeArr"),this.isUseArr=o.get("isUseArr"),this.getMediaDetail()},this.getMediaDetail=function(){var e=n.post(ApiDefines.MEDIA_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.mediaDetailResult=e.data)}.bind(this))}.bind(this),this.doPagingSearch_promotion=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.PROMOTION_LIST,s={entityDTO:{mediaId:this.mediaInfo.mediaId},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]};n.post(i,s).then(function(e){1==e.code?(this.promotionList=e.data.records,this.totalPages_promotion=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.doPagingSearch_audit=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEDIA_AUDIT_DETAIL,s={entityDTO:{businessId:this.mediaInfo.mediaId},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"createTime",type:"desc"}]};n.post(i,s).then(function(e){1==e.code?(this.auditList=e.data.records,this.totalPages_audit=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.mediaList")}}function MediaListContext(e,t,i,s,n){this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.getDictionarys=function(e){var t=$.Deferred(),i=ApiDefines.DROP_DOWN_LIST,n={entityDTO:{
typeCode:e}};return s.post(i,n).then(function(e){if(1==e.code)t.resolve(e.data);else{var i=e.message;t.reject(i)}}.bind(this)),t}.bind(this),this.getWebsiteType=function(){this.websiteTypeArr=n.get(DropDownListDefines.SITE_TYPE),this.websiteTypeResult||this.getDictionarys(DropDownListDefines.SITE_TYPE).then(function(e){this.websiteTypeArr=e,n.set(DropDownListDefines.SITE_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getMediaStatus=function(){this.mediaStatusArr=n.get(DropDownListDefines.MEDIA_STATUS),this.mediaStatusResult||this.getDictionarys(DropDownListDefines.MEDIA_STATUS).then(function(e){this.mediaStatusArr=e,n.set(DropDownListDefines.MEDIA_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getMediaType=function(){this.mediaTypeArr=n.get(DropDownListDefines.MEDIA_TYPE),this.mediaTypeResult||this.getDictionarys(DropDownListDefines.MEDIA_TYPE).then(function(e){this.mediaTypeArr=e,n.set(DropDownListDefines.MEDIA_TYPE,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.getIsUse=function(){this.isUseArr=n.get(DropDownListDefines.MEDIA_USE_STATUS),this.isUseResult||this.getDictionarys(DropDownListDefines.MEDIA_USE_STATUS).then(function(e){this.isUseArr=e,n.set(DropDownListDefines.MEDIA_USE_STATUS,e,{exp:Constants.EXP_TIME})}.bind(this),function(e){this.popAlert(e,"error")}.bind(this))}.bind(this),this.queryModel={entityDTO:{}},this.pageUtil={pageDTO:{pageSize:PageConfig.INIT_PAGE_SIZE,pageNo:PageConfig.INIT_PAGE_INDEX}},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}]},this.execute=function(){this.getWebsiteType(),this.getMediaStatus(),this.getMediaType(),this.getIsUse()},this.viewMediaInfo=function(t){e.go("main.mediaInfo",{data:{mediaInfo:t,websiteTypeArr:this.websiteTypeArr,mediaStatusArr:this.mediaStatusArr,mediaTypeArr:this.mediaTypeArr,isUseArr:this.isUseArr}});var i={name:"媒体管理",sref:"main.mediaPromotion"};this.doActiveMenu(i)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.MEDIA_LIST,n=angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel);void 0!=n.entityDTO.endCreateDate&&(n.entityDTO.endCreateDate=n.entityDTO.endCreateDate+" 23:59:00"),void 0!=n.entityDTO.startCreateDate&&(n.entityDTO.startCreateDate=n.entityDTO.startCreateDate+" 00:00:00"),s.post(i,n).then(function(e){void 0!=n.entityDTO.endCreateDate&&(n.entityDTO.endCreateDate=n.entityDTO.endCreateDate.split(" ")[0]),void 0!=n.entityDTO.startCreateDate&&(n.entityDTO.startCreateDate=n.entityDTO.startCreateDate.split(" ")[0]),1==e.code?(this.searchedMediasList=e.data.records,this.totalPages=e.data.pageDTO.totalCount):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.addBlackListConfirm={opened:!1,ok:void 0,cancel:void 0},this.addBlackList=function(e){this.addBlackListConfirm.opened=!0,this.addBlackListConfirm.ok=function(){var t=ApiDefines.ADD_BLACK_LIST,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("设置黑名单成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.repleaseBlackListConfirm={opened:!1,ok:void 0,cancel:void 0},this.repleaseBlackList=function(e){this.repleaseBlackListConfirm.opened=!0,this.repleaseBlackListConfirm.ok=function(){var t=ApiDefines.RELEASE_BLACK_LIST,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("解除黑名单成功","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.freezeConfirm={opened:!1,ok:void 0,cancel:void 0},this.freeze=function(e){this.freezeConfirm.opened=!0,this.freezeConfirm.ok=function(){var t=ApiDefines.FEEZE,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert(e.message,"success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.unFreezeConfirm={opened:!1,ok:void 0,cancel:void 0},this.unFreeze=function(e){this.unFreezeConfirm.opened=!0,this.unFreezeConfirm.ok=function(){var t=ApiDefines.UNFEEZE,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert("已经解冻！","success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.recoverAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.recoverAudit=function(e){this.recoverAuditConfirm.opened=!0,this.recoverAuditConfirm.ok=function(){var t=ApiDefines.RECOVER_AUDIT,i={entityDTO:{mediaId:e}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert(e.message,"success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.searchedMediasList.length?this.checkedRows=[]:this.checkedRows=[].concat(this.searchedMediasList)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e.mediaId)},this.doResetMedia=function(){this.queryModel={entityDTO:{}}}}function MemberAuditContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.queryMemberAuditListResult={},this.accountTypeResult={},this.memberTypeResult={},this.memberApproveTypeResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.query={entityDTO:{}},this.orderUtil={orderDTOs:[{propertyName:"up_regist_date",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getAccountType(),this.getMemberType(),this.getMemberApproveType(),this.queryModel.entityDTO.accountType="0",this.queryModel.entityDTO.approveType="0",this.roleCode=UserUtil.getUserRole()},this.memberAudit=function(t){e.go("main.memberAuditInfo",{data:{memberId:t.memberId,approveType:t.approveType}});var i={name:"会员管理",sref:"main.promotionActive"};this.doActiveMenu(i)},this.getAccountType=function(){if(this.accountTypeResult=n.get(DropDownListDefines.ACCOUNT_TYPE),!this.accountTypeResult){var e=s.getDropDownList(DropDownListDefines.ACCOUNT_TYPE);e.then(function(e){"1"==e.code&&(this.accountTypeResult=e.data,n.set(DropDownListDefines.ACCOUNT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberType=function(){if(this.memberTypeResult=n.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeResult=e.data,n.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveType=function(){if(this.memberApproveTypeResult=n.get(DropDownListDefines.MEMBER_APPROVE_TYPE),!this.memberApproveTypeResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_APPROVE_TYPE);e.then(function(e){"1"==e.code&&(this.memberApproveTypeResult=e.data,n.set(DropDownListDefines.MEMBER_APPROVE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.MEMBER_AUDIT_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryMemberAuditListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.exportReport=function(){"undefined"!=typeof index&&(this.pageIndex=index),"undefined"!=typeof pageSize&&(this.pageSize=pageSize);var e=s.post(ApiDefines.EXPORT_MEMBER_BANK_INFO,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));e.then(function(e){"1"==e.code?window.open(n.get("FILE_SERVER_PATH")+ApiDefines.FILE_DOWN+"?downFileName="+e.data.downFileName):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.approveConfirm={opened:!1,ok:void 0,cancel:void 0},this.batchApprovePass=function(){return 0==this.checkedRows.length?void this.popAlert("请选择需要审核的会员","error"):(this.approveConfirm.opened=!0,this.msg="你已选择"+this.checkedRows.length+"个会员，确定审核通过？",void(this.approveConfirm.ok=function(){this.query.entityDTO.memberIdList=this.checkedRows;var e=s.post(ApiDefines.BATCH_APPROVE,angular.extend(this.query));e.then(function(e){"1"==e.code?(this.popAlert("批量审核操作已完成","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)))},this.checkedRows=[],this.checkAllRows=function(){if(this.checkedRows.length==this.queryMemberAuditListResult.length)this.checkedRows=[];else for(var e=0;e<this.queryMemberAuditListResult.length;e++)this.checkedRows.indexOf(this.queryMemberAuditListResult[e].memberId)==-1&&this.checkedRows.push(this.queryMemberAuditListResult[e].memberId)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)},this.reset=function(){this.queryModel={entityDTO:{}}}}function MemberAuditInfoContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.approveModel={entityDTO:{}},this.viewModel={entityDTO:{}},this.memberDetailResult={},this.approve={entityDTO:{}},this.hidden=!1,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryMemberAuditListResult={},this.memberTypeResult={},this.accountTypeResult={},this.memberApproveStatusResult={},this.accountStatusResult={},this.memberApproveTypeResult={},this.taxTypeResult={},this.memberApproveRemarkResult={},this.memberApproveResult={},this.orderUtil={orderDTOs:[{propertyName:"createTime",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){t.data&&(o.set("memberId",t.data.memberId,{exp:86400}),o.set("approveType",t.data.approveType,{exp:86400})),this.queryModel.entityDTO.memberId=o.get("memberId"),this.queryModel.entityDTO.approveType=o.get("approveType"),this.query.entityDTO.businessId=o.get("memberId"),this.approveModel.entityDTO.memberId=o.get("memberId"),this.getMemberDetail(),this.getMemberType(),this.getAccountType(),this.getMemberApproveStatus(),this.getAccountStatus(),this.getMemberApproveType(),this.getTaxType(),this.getMemberApproveRemark(),this.roleCode=UserUtil.getUserRole(),this.getMemberApproveResult()},this.getMemberDetail=function(){var e=n.post(ApiDefines.MEMBER_DETAIL,angular.extend(this.queryModel));e.then(function(e){if("1"==e.code){this.memberDetailResult=e.data,this.businessLicenseTemp=e.data.businessLicenseUrl,this.taxRegistrationTemp=e.data.taxRegistrationUrl,this.corporateIdentityCardTemp=e.data.corporateIdentityCardUrl,this.contactIdentityCardTemp=e.data.contactIdentityCardUrl,this.supplierBankConfirmTemp=e.data.supplierBankConfirmUrl;var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.businessLicenseTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业营业执照副本复印件加盖公章",this.piccArray[0]={picName:this.picName,src:e.data.pictureData,url:this.businessLicenseTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.taxRegistrationTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业税务登记证副本复印件加盖公章",this.piccArray[1]={picName:this.picName,src:e.data.pictureData,url:this.taxRegistrationTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.corporateIdentityCardTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业法人身份证正反面复印件加盖公章",this.piccArray[2]={picName:this.picName,src:e.data.pictureData,url:this.corporateIdentityCardTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.contactIdentityCardTemp}}));t.then(function(e){"1"==e.code?(this.picName="联系人身份证正反面复印件加盖公章",this.piccArray[3]={picName:this.picName,src:e.data.pictureData,url:this.contactIdentityCardTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.supplierBankConfirmTemp}}));t.then(function(e){"1"==e.code?(this.picName="供应商银行信息确认函",this.piccArray[4]={picName:this.picName,src:e.data.pictureData,url:this.supplierBankConfirmTemp}):this.popAlert(e.message,"error")}.bind(this));var i=e.data.updateColumns;void 0!=i&&i.length>0&&i.forEach(function(e,t){$("."+e).css("color","red")})}}.bind(this))}.bind(this),this.getAccountStatus=function(){if(this.accountStatusResult=o.get(DropDownListDefines.ACCOUNT_STATUS),!this.accountStatusResult){var e=n.getDropDownList(DropDownListDefines.ACCOUNT_STATUS);e.then(function(e){"1"==e.code&&(this.accountStatusResult=e.data,o.set(DropDownListDefines.ACCOUNT_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getTaxType=function(){if(this.taxTypeResult=o.get(DropDownListDefines.TAX_TYPE),!this.taxTypeResult){var e=n.getDropDownList(DropDownListDefines.TAX_TYPE);e.then(function(e){"1"==e.code&&(this.taxTypeResult=e.data,o.set(DropDownListDefines.TAX_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberType=function(){if(this.memberTypeResult=o.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeResult=e.data,o.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveType=function(){if(this.memberApproveTypeResult=o.get(DropDownListDefines.MEMBER_APPROVE_TYPE),!this.memberApproveTypeResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_APPROVE_TYPE);e.then(function(e){"1"==e.code&&(this.memberApproveTypeResult=e.data,o.set(DropDownListDefines.MEMBER_APPROVE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveStatus=function(){if(this.memberApproveStatusResult=o.get(DropDownListDefines.MEMBER_APPROVE_STATUS),!this.memberApproveStatusResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_APPROVE_STATUS);e.then(function(e){"1"==e.code&&(this.memberApproveStatusResult=e.data,o.set(DropDownListDefines.MEMBER_APPROVE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveResult=function(){if(this.memberApproveResult=o.get(DropDownListDefines.APPROVE_RESULT),!this.memberApproveResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.memberApproveResult=e.data,o.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAccountType=function(){if(this.accountTypeResult=o.get(DropDownListDefines.ACCOUNT_TYPE),!this.accountTypeResult){var e=n.getDropDownList(DropDownListDefines.ACCOUNT_TYPE);e.then(function(e){"1"==e.code&&(this.accountTypeResult=e.data,o.set(DropDownListDefines.ACCOUNT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveRemark=function(){if(this.memberApproveRemarkResult=o.get(DropDownListDefines.MEMBER_APPROVE_REMARK),!this.memberApproveRemarkResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_APPROVE_REMARK);e.then(function(e){"1"==e.code&&(this.memberApproveRemarkResult=e.data,o.set("memberApproveRemarkResult",this.memberApproveRemarkResult,{exp:86400}),o.set(DropDownListDefines.MEMBER_APPROVE_REMARK,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.MEMBER_AUDIT_INFO,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.query));i.then(function(e){"1"==e.code?(this.queryMemberAuditListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.noPassReason={opened:!1,ok:void 0,cancel:void 0},this.approveNotPass=function(t){this.noPassReason.opened=!0,this.noPassReason.ok=function(i){this.approveModel.entityDTO.approveResult=t,this.approveModel.entityDTO.failedReason=i;var s=n.post(ApiDefines.APPROVE_MEMBER_INFO,angular.extend(this.approveModel));s.then(function(t){"1"==t.code?(this.popAlert("审核操作已完成","success"),e.go("main.memberAudit")):this.popAlert(t.message,"error")}.bind(this))}.bind(this)},this.approvePass=function(t){this.approveModel.entityDTO.approveResult=t;var i=n.post(ApiDefines.APPROVE_MEMBER_INFO,angular.extend(this.approveModel));i.then(function(t){"1"==t.code?(this.popAlert("审核操作已完成","success"),e.go("main.memberAudit")):this.popAlert(t.message,"error")}.bind(this))}.bind(this),this.piccArray=new Array(5),this.preview=function(e){"business_license"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.businessLicenseTemp},this.picName="企业营业执照副本复印件加盖公章"):"tax_registration"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.taxRegistrationTemp},this.picName="企业税务登记证副本复印件加盖公章"):"corporate_identity_card"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.corporateIdentityCardTemp},this.picName="企业法人身份证正反面复印件加盖公章"):"contact_identity_card"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.contactIdentityCardTemp},this.picName="联系人身份证正反面复印件加盖公章"):"supplier_bank_confirm"==e&&(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.supplierBankConfirmTemp},this.picName="供应商银行信息确认函");var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));t.then(function(e){"1"==e.code?(this.src=e.data.pictureData,this.viewPicture=ModalUtil.createModal(a,ModalPath.MEMBER_VIEW_PICTURE,this,"lg")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function MemberDetailContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.memberDetailResult={},this.hidden=!1,this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryMemberAuditListResult={},this.memberTypeResult={},this.accountTypeResult={},this.memberApproveStatusResult={},this.accountStatusResult={},this.memberApproveTypeResult={},this.taxTypeResult={},this.memberApproveResult={},this.viewModel={entityDTO:{}},this.orderUtil={orderDTOs:[{propertyName:"createTime",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){t.data&&(o.set("memberId",t.data.memberId,{exp:86400}),o.set("approveType",t.data.approveType,{exp:86400})),this.queryModel.entityDTO.memberId=o.get("memberId"),this.queryModel.entityDTO.approveType=o.get("approveType"),this.query.entityDTO.businessId=o.get("memberId"),this.getMemberDetail(),this.getMemberType(),this.getAccountType(),this.getMemberApproveStatus(),this.getAccountStatus(),this.getMemberApproveType(),this.getTaxType(),this.getMemberApproveResult()},this.piccArray=new Array(5),this.getPicSrc=function(e){var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(e));t.then(function(e){"1"==e.code?this.src=e.data.pictureData:this.popAlert(e.message,"error")}.bind(this))},this.preview=function(e){"business_license"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.businessLicenseTemp},this.picName="企业营业执照副本复印件加盖公章"):"tax_registration"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.taxRegistrationTemp},this.picName="企业税务登记证副本复印件加盖公章"):"corporate_identity_card"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.corporateIdentityCardTemp},this.picName="企业法人身份证正反面复印件加盖公章"):"contact_identity_card"==e?(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.contactIdentityCardTemp},this.picName="联系人身份证正反面复印件加盖公章"):"supplier_bank_confirm"==e&&(this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.supplierBankConfirmTemp},this.picName="供应商银行信息确认函"),this.getPicSrc(this.viewModel),this.viewPicture=ModalUtil.createModal(a,ModalPath.MEMBER_VIEW_PICTURE,this,"lg")}.bind(this),this.getMemberApproveResult=function(){if(this.memberApproveResult=o.get(DropDownListDefines.APPROVE_RESULT),!this.memberApproveResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_RESULT);e.then(function(e){"1"==e.code&&(this.memberApproveResult=e.data,o.set(DropDownListDefines.APPROVE_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberDetail=function(){var e=n.post(ApiDefines.MEMBER_DETAIL,angular.extend(this.queryModel));e.then(function(e){if("1"==e.code){this.memberDetailResult=e.data,this.businessLicenseTemp=e.data.businessLicenseUrl,this.taxRegistrationTemp=e.data.taxRegistrationUrl,this.corporateIdentityCardTemp=e.data.corporateIdentityCardUrl,this.contactIdentityCardTemp=e.data.contactIdentityCardUrl,this.supplierBankConfirmTemp=e.data.supplierBankConfirmUrl;var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.businessLicenseTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业营业执照副本复印件加盖公章",this.piccArray[0]={picName:this.picName,src:e.data.pictureData,url:this.businessLicenseTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.taxRegistrationTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业税务登记证副本复印件加盖公章",this.piccArray[1]={picName:this.picName,src:e.data.pictureData,url:this.taxRegistrationTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.corporateIdentityCardTemp}}));t.then(function(e){"1"==e.code?(this.picName="企业法人身份证正反面复印件加盖公章",this.piccArray[2]={picName:this.picName,src:e.data.pictureData,url:this.corporateIdentityCardTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.contactIdentityCardTemp}}));t.then(function(e){"1"==e.code?(this.picName="联系人身份证正反面复印件加盖公章",this.piccArray[3]={picName:this.picName,src:e.data.pictureData,url:this.contactIdentityCardTemp}):this.popAlert(e.message,"error")}.bind(this));var t=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend({entityDTO:{isTmpPic:!1,picUrl:this.supplierBankConfirmTemp}}));t.then(function(e){"1"==e.code?(this.picName="供应商银行信息确认函",this.piccArray[4]={picName:this.picName,src:e.data.pictureData,url:this.supplierBankConfirmTemp}):this.popAlert(e.message,"error")}.bind(this));var i=e.data.updateColumns;void 0!=i&&i.length>0&&i.forEach(function(e,t){$("."+e).css("color","red")})}else this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getAccountStatus=function(){if(this.accountStatusResult=o.get(DropDownListDefines.ACCOUNT_STATUS),!this.accountStatusResult){var e=n.getDropDownList(DropDownListDefines.ACCOUNT_STATUS);e.then(function(e){"1"==e.code&&(this.accountStatusResult=e.data,o.set(DropDownListDefines.ACCOUNT_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getTaxType=function(){if(this.taxTypeResult=o.get(DropDownListDefines.TAX_TYPE),!this.taxTypeResult){var e=n.getDropDownList(DropDownListDefines.TAX_TYPE);e.then(function(e){"1"==e.code&&(this.taxTypeResult=e.data,o.set(DropDownListDefines.TAX_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberType=function(){if(this.memberTypeResult=o.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeResult=e.data,o.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveType=function(){if(this.memberApproveTypeResult=o.get(DropDownListDefines.MEMBER_APPROVE_TYPE),!this.memberApproveTypeResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_APPROVE_TYPE);e.then(function(e){"1"==e.code&&(this.memberApproveTypeResult=e.data,o.set(DropDownListDefines.MEMBER_APPROVE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveStatus=function(){if(this.memberApproveStatusResult=o.get(DropDownListDefines.MEMBER_APPROVE_STATUS),!this.memberApproveStatusResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_APPROVE_STATUS);e.then(function(e){"1"==e.code&&(this.memberApproveStatusResult=e.data,o.set(DropDownListDefines.MEMBER_APPROVE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAccountType=function(){if(this.accountTypeResult=o.get(DropDownListDefines.ACCOUNT_TYPE),!this.accountTypeResult){var e=n.getDropDownList(DropDownListDefines.ACCOUNT_TYPE);e.then(function(e){"1"==e.code&&(this.accountTypeResult=e.data,o.set(DropDownListDefines.ACCOUNT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.MEMBER_AUDIT_INFO,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.query));i.then(function(e){"1"==e.code?(this.queryMemberAuditListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function MemberInfoContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.viewModel={entityDTO:{}},this.taxTypeResult={},this.businessLicense="0",this.taxRegistration="0",this.corporateIdentityCard="0",this.contactIdentityCard="0",this.supplierBankConfirm="0",this.execute=function(){this.getBankNameList(),this.getTaxType()},this.getTaxType=function(){if(this.taxTypeResult=n.get(DropDownListDefines.TAX_TYPE),!this.taxTypeResult){var e=s.getDropDownList(DropDownListDefines.TAX_TYPE);e.then(function(e){"1"==e.code&&(this.taxTypeResult=e.data,n.set(DropDownListDefines.TAX_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.createMember=function(e){if(this.sumbmited=!0,e){this.queryModel.entityDTO.memberType=1,this.queryModel.entityDTO.accountType=2;var t=s.post(ApiDefines.CREATE_MEMBER,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?this.popAlert("用户创建成功","success"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.getBankNameList=function(){var e=s.post(ApiDefines.BANK_NAME_LIST,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.bankNameListResult=e.data)}.bind(this))}.bind(this),this.getProvinceNameList=function(e){this.query.entityDTO={bankName:e};var t=s.post(ApiDefines.PROVINCE_NAME_LIST,angular.extend(this.query));t.then(function(e){"1"==e.code&&(this.provinceNameListResult=e.data)}.bind(this))}.bind(this),this.getCityNameList=function(e,t){this.query.entityDTO={bankName:e,bankProvinceName:t};var i=s.post(ApiDefines.CITY_NAME_LIST,angular.extend(this.query));i.then(function(i){"1"==i.code&&(this.cityNameListResult=i.data,this.localCity!=t&&(this.queryModel.entityDTO.recipientBankProvince=this.cityNameListResult[0].bankCityName,this.getBranchBankList(e,t,this.cityNameListResult[0].bankCityName)))}.bind(this))}.bind(this),this.getBranchBankList=function(e,t,i){this.query.entityDTO={bankName:e,bankProvinceName:t,bankCityName:i};var n=s.post(ApiDefines.BRANCH_BANK_INFO_LIST,angular.extend(this.query));n.then(function(e){"1"==e.code&&(this.branchBankListResult=e.data)}.bind(this))}.bind(this),this.queryBankByBranchBankName=function(e,t,i,n){this.query.entityDTO={bankName:e,bankProvinceName:t,bankCityName:i,bankBranchName:n};var o=s.post(ApiDefines.QUERY_BRANCH_BANK_INFO_LIST,angular.extend(this.query));o.then(function(e){"1"==e.code&&(this.branchBankListResult=e.data,this.queryCompanyAccInfoResult.recipientBankBranch=e.data[0].bankBranchName+","+e.data[0].bankBranchNum,this.queryModel.entityDTO.recipientBankBranch=e.data[0].bankBranchName+","+e.data[0].bankBranchNum)}.bind(this))}.bind(this),this.enBusLicenBackUpUploaderBusinessLicenseUrl=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"business_license"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.businessLicense="1",this.queryModel.entityDTO.businessLicenseUrl=e.fileUrl,this.businessLicenseTemp=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.enBusLicenBackUpUploaderTaxRegistrationUrl=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"tax_registration"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.taxRegistration="1",this.queryModel.entityDTO.taxRegistrationUrl=e.fileUrl,this.taxRegistrationTemp=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.enBusLicenBackUpUploaderCorporateIdentityCardUrl=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"corporate_identity_card"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.corporateIdentityCard="1",this.queryModel.entityDTO.corporateIdentityCardUrl=e.fileUrl,this.corporateIdentityCardTemp=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.enBusLicenBackUpUploaderContactIdentityCardUrl=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"contact_identity_card"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.contactIdentityCard="1",this.queryModel.entityDTO.contactIdentityCardUrl=e.fileUrl,this.contactIdentityCardTemp=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.enBusLicenBackUpUploaderSupplierBankConfirmUrl=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{bFileType:"supplier_bank_confirm"}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.supplierBankConfirm="1",this.queryModel.entityDTO.supplierBankConfirmUrl=e.fileUrl,this.supplierBankConfirmTemp=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.preview=function(e){"business_license"==e?this.viewModel.entityDTO={isTmpPic:!0,picUrl:this.businessLicenseTemp}:"tax_registration"==e?this.viewModel.entityDTO={isTmpPic:!0,picUrl:this.taxRegistrationTemp}:"corporate_identity_card"==e?this.viewModel.entityDTO={isTmpPic:!0,picUrl:this.corporateIdentityCardTemp}:"contact_identity_card"==e?this.viewModel.entityDTO={isTmpPic:!0,picUrl:this.contactIdentityCardTemp}:"supplier_bank_confirm"==e&&(this.viewModel.entityDTO={isTmpPic:!0,picUrl:this.supplierBankConfirmTemp});var t=s.post(n.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));t.then(function(e){"1"==e.code?(this.viewPicture=ModalUtil.createModal(a,ModalPath.VIEW_PICTURE,this,"md"),this.src=e.data.pictureData):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}},this.modify=function(e){"1"==e&&(this.businessLicense="0"),"2"==e&&(this.taxRegistration="0"),"3"==e&&(this.corporateIdentityCard="0"),"4"==e&&(this.contactIdentityCard="0"),"5"==e&&(this.supplierBankConfirm="0")}.bind(this)}function MemberListContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryMemberListResult={},this.memberTypeResult={},
this.accountTypeResult={},this.memberApproveStatusResult={},this.accountStatusResult={},this.memberApproveTypeResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getMemberType(),this.getAccountType(),this.getMemberApproveStatus(),this.getAccountStatus(),this.getMemberApproveType()},this.viewMemberInfo=function(t){e.go("main.memberDetail",{data:{memberId:t.memberId,approveType:t.approveType}});var i={name:"会员管理",sref:"main.promotionActive"};this.doActiveMenu(i)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.MEMBER_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryMemberListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getMemberType=function(){if(this.memberTypeResult=n.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeResult=e.data,n.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAccountType=function(){if(this.accountTypeResult=n.get(DropDownListDefines.ACCOUNT_TYPE),!this.accountTypeResult){var e=s.getDropDownList(DropDownListDefines.ACCOUNT_TYPE);e.then(function(e){"1"==e.code&&(this.accountTypeResult=e.data,n.set(DropDownListDefines.ACCOUNT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveStatus=function(){if(this.memberApproveStatusResult=n.get(DropDownListDefines.MEMBER_APPROVE_STATUS),!this.memberApproveStatusResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_APPROVE_STATUS);e.then(function(e){"1"==e.code&&(this.memberApproveStatusResult=e.data,n.set(DropDownListDefines.MEMBER_APPROVE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAccountStatus=function(){if(this.accountStatusResult=n.get(DropDownListDefines.ACCOUNT_STATUS),!this.accountStatusResult){var e=s.getDropDownList(DropDownListDefines.ACCOUNT_STATUS);e.then(function(e){"1"==e.code&&(this.accountStatusResult=e.data,n.set(DropDownListDefines.ACCOUNT_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberApproveType=function(){if(this.memberApproveTypeResult=n.get(DropDownListDefines.MEMBER_APPROVE_TYPE),!this.memberApproveTypeResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_APPROVE_TYPE);e.then(function(e){"1"==e.code&&(this.memberApproveTypeResult=e.data,n.set(DropDownListDefines.MEMBER_APPROVE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}},this.setBlacklistConfirm={opened:!1,ok:void 0,cancel:void 0},this.setBlacklist=function(e){this.setBlacklistConfirm.opened=!0,this.setBlacklistConfirm.ok=function(){this.queryModel.entityDTO.memberId=e;var t=s.post(ApiDefines.SET_BLACK_LIST,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("设置黑名单成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.removeBlacklistConfirm={opened:!1,ok:void 0,cancel:void 0},this.removeBlacklist=function(e){this.removeBlacklistConfirm.opened=!0,this.removeBlacklistConfirm.ok=function(){this.queryModel.entityDTO.memberId=e;var t=s.post(ApiDefines.REMOVE_BLACK_LIST,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("解除黑名单成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.freezeConfirm={opened:!1,ok:void 0,cancel:void 0},this.freeze=function(e){this.freezeConfirm.opened=!0,this.freezeConfirm.ok=function(){this.queryModel.entityDTO.memberId=e;var t=s.post(ApiDefines.FREEZE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("冻结成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.unfreezeConfirm={opened:!1,ok:void 0,cancel:void 0},this.unfreeze=function(e){this.unfreezeConfirm.opened=!0,this.unfreezeConfirm.ok=function(){this.queryModel.entityDTO.memberId=e;var t=s.post(ApiDefines.UN_FREEZE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("解冻成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.recoverApproveConfirm={opened:!1,ok:void 0,cancel:void 0},this.recoverApprove=function(e){this.recoverApproveConfirm.opened=!0,this.recoverApproveConfirm.ok=function(){this.queryModel.entityDTO.memberId=e;var t=s.post(ApiDefines.RECOVER_APPROVE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("恢复审核成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}}function MemberMessageListContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.queryMemberMessageListResult={},this.userMessageStatusResult={},this.messageTypeResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getUserMessageStatus(),this.getMessageType()},this.viewMessageInfo=function(t){var i=s.post(ApiDefines.MEMBER_MESSAGE_DETAIL,angular.extend({entityDTO:{userMessageId:t.userMessageId}}));i.then(function(t){"1"==t.code&&(this.memberMessageDetailResult=t.data,e.go("main.messageDetail",{data:{userMessageInfo:this.memberMessageDetailResult}}))}.bind(this));var n={name:"消息管理",sref:"main.myPromotion"};this.doActiveMenu(n)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.MEMBER_MESSAGE_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryMemberMessageListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getUserMessageStatus=function(){if(this.userMessageStatusResult=n.get(DropDownListDefines.USER_MESSAGE_STATUS),!this.userMessageStatusResult){var e=s.getDropDownList(DropDownListDefines.USER_MESSAGE_STATUS);e.then(function(e){"1"==e.code&&(this.userMessageStatusResult=e.data,n.set(DropDownListDefines.USER_MESSAGE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMessageType=function(){if(this.messageTypeResult=n.get(DropDownListDefines.MESSAGE_TYPE),!this.messageTypeResult){var e=s.getDropDownList(DropDownListDefines.MESSAGE_TYPE);e.then(function(e){"1"==e.code&&(this.messageTypeResult=e.data,n.set(DropDownListDefines.MESSAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}}}function MessageCreateContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.hidden_range=0,this.hidden_member=0,this.error_message_accountType=0,this.error_message_memberType=0,this.error_message_content=0,this.error_message_memberIds=0,this.execute=function(){},this.changed=function(){""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content?$("#contentError").show():$("#contentError").hide()}.bind(this),this.sendMessage=function(t){if(this.sumbmited=!0,0==this.accountTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_accountType=1);if(this.error_message_accountType=0,0==this.memberTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_memberType=1);if(this.error_message_memberType=0,3==this.queryModel.entityDTO.reciverRange&&(""==this.queryModel.entityDTO.memberIds||null==this.queryModel.entityDTO.memberIds))return void(this.error_message_memberIds=1);if(this.error_message_memberIds=0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.error_message_content=1);if(this.error_message_content=0,t){0!=this.accountTypeRows.length&&(this.accountTypeRows.length>=2?this.queryModel.entityDTO.accountType=0:this.queryModel.entityDTO.accountType=this.accountTypeRows[0]),0!=this.memberTypeRows.length&&(this.memberTypeRows.length>=2?this.queryModel.entityDTO.memberType=0:this.queryModel.entityDTO.memberType=this.memberTypeRows[0]),3!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.memberIds=""),2!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.accountType="",this.queryModel.entityDTO.memberType="");var i=s.post(ApiDefines.SAVE_SEND_MESSAGE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("消息发送成功","success"),e.go("main.messageList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.saveMessage=function(t){if(this.sumbmited=!0,0==this.accountTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_accountType=1);if(this.error_message_accountType=0,0==this.memberTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_memberType=1);if(this.error_message_memberType=0,3==this.queryModel.entityDTO.reciverRange&&(""==this.queryModel.entityDTO.memberIds||null==this.queryModel.entityDTO.memberIds))return void(this.error_message_memberIds=1);if(this.error_message_memberIds=0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.error_message_content=1);if(this.error_message_content=0,t){0!=this.accountTypeRows.length&&(this.accountTypeRows.length>=2?this.queryModel.entityDTO.accountType=0:this.queryModel.entityDTO.accountType=this.accountTypeRows[0]),0!=this.memberTypeRows.length&&(this.memberTypeRows.length>=2?this.queryModel.entityDTO.memberType=0:this.queryModel.entityDTO.memberType=this.memberTypeRows[0]),3!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.memberIds=""),2!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.accountType="",this.queryModel.entityDTO.memberType="");var i=s.post(ApiDefines.CREATE_MESSAGE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("消息创建成功","success"),e.go("main.messageList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.accountTypeRows=[],this.memberTypeRows=[],this.accountTypeRow=function(e){var t=this.accountTypeRows.indexOf(e);t!=-1?this.accountTypeRows.splice(t,1):this.accountTypeRows.push(e)},this.memberTypeRow=function(e){var t=this.memberTypeRows.indexOf(e);t!=-1?this.memberTypeRows.splice(t,1):this.memberTypeRows.push(e)},this.reset=function(){this.queryModel={entityDTO:{}}},this.goBack=function(){e.go("main.messageList")},this.downloadTemplateFile=function(){window.open("http://"+window.location.host+"/resources/messageMemberIdsImport.xlsx")},this.enBusLicenBackUpUploaderCorporateIdentityCardUrl=UploaderUtil.create(o,{url:"http://"+window.location.host+ApiDefines.IMPORT_MEMBER_ID,formData:[{}],alias:"file",autoUpload:!0,filters:["xslFilter"],success:function(e){"1"==e.code?(this.queryModel.entityDTO.memberIds=e.memberIds,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)})}function MessageDetailContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.memberMessageDetailResult={},this.userMessageStatusResult={},this.messageTypeResult={},this.execute=function(){t.data&&o.set("userMessageInfo",t.data.userMessageInfo,{exp:86400}),this.memberMessageDetailResult=o.get("userMessageInfo"),this.getUserMessageStatus(),this.getMessageType()},this.getUserMessageStatus=function(){if(this.userMessageStatusResult=o.get(DropDownListDefines.USER_MESSAGE_STATUS),!this.userMessageStatusResult){var e=n.getDropDownList(DropDownListDefines.USER_MESSAGE_STATUS);e.then(function(e){"1"==e.code&&(this.userMessageStatusResult=e.data,o.set(DropDownListDefines.USER_MESSAGE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMessageType=function(){if(this.messageTypeResult=o.get(DropDownListDefines.MESSAGE_TYPE),!this.messageTypeResult){var e=n.getDropDownList(DropDownListDefines.MESSAGE_TYPE);e.then(function(e){"1"==e.code&&(this.messageTypeResult=e.data,o.set(DropDownListDefines.MESSAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberMessageDetail=function(){var e=n.post(ApiDefines.MEMBER_MESSAGE_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.memberMessageDetailResult=e.data)}.bind(this))}.bind(this)}function MessageEditContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.memberMessageDetailResult={},this.userMessageStatusResult={},this.messageTypeResult={},this.hidden_range=0,this.hidden_member=0,this.error_message_accountType=0,this.error_message_memberType=0,this.error_message_content=0,this.error_message_memberIds=0,this.execute=function(){o.data&&n.set("messageInfo",o.data.messageInfo,{exp:86400}),this.queryModel.entityDTO.messageId=n.get("messageInfo").messageId,this.getMemberMessageDetail(this.queryModel.entityDTO.messageId),this.queryModel.entityDTO.content=n.get("messageInfo").content,this.getUserMessageStatus(),this.getMessageType()},this.changed=function(){""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content?$("#contentError").show():$("#contentError").hide()}.bind(this),this.getUserMessageStatus=function(){if(this.userMessageStatusResult=n.get(DropDownListDefines.USER_MESSAGE_STATUS),!this.userMessageStatusResult){var e=s.getDropDownList(DropDownListDefines.USER_MESSAGE_STATUS);e.then(function(e){"1"==e.code&&(this.userMessageStatusResult=e.data,n.set(DropDownListDefines.USER_MESSAGE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMessageType=function(){if(this.messageTypeResult=n.get(DropDownListDefines.MESSAGE_TYPE),!this.messageTypeResult){var e=s.getDropDownList(DropDownListDefines.MESSAGE_TYPE);e.then(function(e){"1"==e.code&&(this.messageTypeResult=e.data,n.set(DropDownListDefines.MESSAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.sendMessage=function(t){if(this.sumbmited=!0,0==this.accountTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_accountType=1);if(this.error_message_accountType=0,0==this.memberTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_memberType=1);if(this.error_message_memberType=0,3==this.queryModel.entityDTO.reciverRange&&(""==this.queryModel.entityDTO.memberIds||null==this.queryModel.entityDTO.memberIds))return void(this.error_message_memberIds=1);if(this.error_message_memberIds=0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.error_message_content=1);if(this.error_message_content=0,t){0!=this.accountTypeRows.length&&(this.accountTypeRows.length>=2?this.queryModel.entityDTO.accountType=0:this.queryModel.entityDTO.accountType=this.accountTypeRows[0]),0!=this.memberTypeRows.length&&(this.memberTypeRows.length>=2?this.queryModel.entityDTO.memberType=0:this.queryModel.entityDTO.memberType=this.memberTypeRows[0]),3!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.memberIds=""),2!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.accountType="",this.queryModel.entityDTO.memberType="");var i=s.post(ApiDefines.SAVE_SEND_MESSAGE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("消息发送成功","success"),e.go("main.messageList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.updateMessage=function(t){if(this.sumbmited=!0,0==this.accountTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_accountType=1);if(this.error_message_accountType=0,0==this.memberTypeRows.length&&2==this.queryModel.entityDTO.reciverRange)return void(this.error_message_memberType=1);if(this.error_message_memberType=0,3==this.queryModel.entityDTO.reciverRange&&(""==this.queryModel.entityDTO.memberIds||null==this.queryModel.entityDTO.memberIds))return void(this.error_message_memberIds=1);if(this.error_message_memberIds=0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.error_message_content=1);if(this.error_message_content=0,t){0!=this.accountTypeRows.length&&(this.accountTypeRows.length>=2?this.queryModel.entityDTO.accountType=0:this.queryModel.entityDTO.accountType=this.accountTypeRows[0]),0!=this.memberTypeRows.length&&(this.memberTypeRows.length>=2?this.queryModel.entityDTO.memberType=0:this.queryModel.entityDTO.memberType=this.memberTypeRows[0]),3!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.memberIds=""),2!=this.queryModel.entityDTO.reciverRange&&(this.queryModel.entityDTO.accountType="",this.queryModel.entityDTO.memberType="");var i=s.post(ApiDefines.UPDATE_MESSAGE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("消息修改成功","success"),e.go("main.messageList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.downloadTemplateFile=function(){window.open("http://"+window.location.host+"/resources/messageMemberIdsImport.xlsx")},this.enBusLicenBackUpUploaderCorporateIdentityCardUrl=UploaderUtil.create(a,{url:"http://"+window.location.host+ApiDefines.IMPORT_MEMBER_ID,formData:[{}],alias:"file",autoUpload:!0,filters:["xslFilter"],success:function(e){"1"==e.code?(this.queryModel.entityDTO.memberIds=e.data.memberIds,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.accountTypeRows=[],this.memberTypeRows=[],this.accountTypeRow=function(e){var t=this.accountTypeRows.indexOf(e);t!=-1?this.accountTypeRows.splice(t,1):this.accountTypeRows.push(e)},this.memberTypeRow=function(e){var t=this.memberTypeRows.indexOf(e);t!=-1?this.memberTypeRows.splice(t,1):this.memberTypeRows.push(e)},this.getMemberMessageDetail=function(e){var t=s.post(ApiDefines.MESSAGE_DETAIL,angular.extend({entityDTO:{messageId:e}}));t.then(function(e){"1"==e.code&&(this.queryModel.entityDTO.reciverRange=e.data.reciverRange,this.queryModel.entityDTO.content=e.data.content,this.queryModel.entityDTO.accountType=e.data.accountType,this.queryModel.entityDTO.memberIds=e.data.memberIds,this.queryModel.entityDTO.title=e.data.title,2==this.queryModel.entityDTO.reciverRange&&(0==this.queryModel.entityDTO.accountType?(this.query.entityDTO.accountAll=!0,this.accountTypeRow(0)):1==this.queryModel.entityDTO.accountType?(this.query.entityDTO.person=!0,this.accountTypeRow(1)):(this.query.entityDTO.company=!0,this.accountTypeRow(2))),this.queryModel.entityDTO.memberType=e.data.memberType,2==this.queryModel.entityDTO.reciverRange&&(0==this.queryModel.entityDTO.memberType?(this.query.entityDTO.memberAll=!0,this.memberTypeRow(0)):1==this.queryModel.entityDTO.memberType?(this.query.entityDTO.platform=!0,this.memberTypeRow(1)):(this.query.entityDTO.normal=!0,this.memberTypeRow(2))))}.bind(this))}.bind(this)}function MessageListContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryMessageListResult={},this.messageStatusResult={},this.messageReceiverRangeResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getMessageStatus(),this.getMessageReceiverRange(),t.data&&(this.queryModel.entityDTO.status=t.data.status)},this.editMessage=function(t){var i=n.post(ApiDefines.MESSAGE_DETAIL,angular.extend({entityDTO:{messageId:t.messageId}}));i.then(function(t){"1"==t.code&&(this.messageDetailResult=t.data,e.go("main.messageEdit",{data:{messageInfo:t.data}}))}.bind(this));var s={name:"消息管理",sref:"main.myPromotion"};this.doActiveMenu(s)},this.viewMessage=function(t){var i=n.post(ApiDefines.MESSAGE_DETAIL,angular.extend({entityDTO:{messageId:t.messageId}}));i.then(function(t){"1"==t.code&&(this.messageDetailResult=t.data,e.go("main.messageView",{data:{messageInfo:t.data}}))}.bind(this));var s={name:"消息管理",sref:"main.myPromotion"};this.doActiveMenu(s)},this.createMessage=function(){e.go("main.messageCreate");var t={name:"消息管理",sref:"main.myPromotion"};this.doActiveMenu(t)},this.sendMessageConfirm={opened:!1,ok:void 0,cancel:void 0},this.sendMessage=function(e){this.sendMessageConfirm.opened=!0,this.sendMessageConfirm.ok=function(){this.queryModel.entityDTO.messageId=e;var t=n.post(ApiDefines.SEND_MESSAGE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("消息发送成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.deleteMessageConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteMessage=function(e){this.deleteMessageConfirm.opened=!0,this.deleteMessageConfirm.ok=function(){this.queryModel.entityDTO.messageId=e;var t=n.post(ApiDefines.DELETE_MESSAGE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.popAlert("消息删除成功","success"),this.doPagingSearch()):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.getMessageStatus=function(){if(this.messageStatusResult=o.get(DropDownListDefines.MESSAGE_STATUS),!this.messageStatusResult){var e=n.getDropDownList(DropDownListDefines.MESSAGE_STATUS);e.then(function(e){"1"==e.code&&(this.messageStatusResult=e.data,o.set(DropDownListDefines.MESSAGE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMessageReceiverRange=function(){if(this.messageReceiverRangeResult=o.get(DropDownListDefines.MESSAGE_RECEIVER_RANGE),!this.messageReceiverRangeResult){var e=n.getDropDownList(DropDownListDefines.MESSAGE_RECEIVER_RANGE);e.then(function(e){"1"==e.code&&(this.messageReceiverRangeResult=e.data,o.set(DropDownListDefines.MESSAGE_RECEIVER_RANGE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.MESSAGE_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryMessageListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}}}function MessageViewContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.messageDetailResult={},this.messageReceiverRangeResult={},this.accountTypeResult={},this.memberTypeResult={},this.execute=function(){t.data&&o.set("messageInfo",t.data.messageInfo,{exp:86400}),this.messageDetailResult=o.get("messageInfo"),this.getMessageReceiverRange(),this.getMemberType(),this.getAccountType()},this.getMessageReceiverRange=function(){if(this.messageReceiverRangeResult=o.get(DropDownListDefines.MESSAGE_RECEIVER_RANGE),!this.messageReceiverRangeResult){var e=n.getDropDownList(DropDownListDefines.MESSAGE_RECEIVER_RANGE);e.then(function(e){"1"==e.code&&(this.messageReceiverRangeResult=e.data,o.set(DropDownListDefines.MESSAGE_RECEIVER_RANGE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberType=function(){if(this.memberTypeResult=o.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeResult){var e=n.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeResult=e.data,o.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getAccountType=function(){if(this.accountTypeResult=o.get(DropDownListDefines.ACCOUNT_TYPE),!this.accountTypeResult){var e=n.getDropDownList(DropDownListDefines.ACCOUNT_TYPE);e.then(function(e){"1"==e.code&&(this.accountTypeResult=e.data,o.set(DropDownListDefines.ACCOUNT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMessageDetail=function(){var e=n.post(ApiDefines.MESSAGE_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.messageDetailResult=e.data)}.bind(this))}}function ViewPictureContext(e,t,i,s){this.queryModel={entityDTO:{}},this.execute=function(){this.picName=this.$parent.picName},this.checkedRows=[],this.checkAllRows=function(){this.checkedRows.length==this.$parent.piccArray.length?this.checkedRows=[]:this.checkedRows=[].concat(this.$parent.piccArray)}.bind(this),this.checkRow=function(e){var t=this.checkedRows.indexOf(e);t!=-1?this.checkedRows.splice(t,1):this.checkedRows.push(e)},this.downloadPic=function(){for(var e=0;e<this.checkedRows.length;e++)window.open("http://"+window.location.host+ApiDefines.CPS_ORDER_DOWNLOAD_ERROR_FILE+this.checkedRows[e].url)},this.close=function(){this.$close()}}function AdditionalOrderSettleContext(e,t,i,s){this.queryModel={entityDTO:{}},this.execute=function(){},this.settlement=function(){var e=s.post(ApiDefines.CPS_ORDER_SETTLEMENT,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?this.popAlert("结算成功","success"):this.popAlert(e.message,"error")}.bind(this))}}function CPSOrderListContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.orderStatusDropList={},this.orderObtanWayDropList={},this.orderPayStatusDropList={},this.reset=function(){this.queryModel={entityDTO:{}}},this.getOrderStatusDropList=function(){if(this.orderStatusDropList=n.get(DropDownListDefines.ORDER_STATUS),!this.mediaTypeResult){var e=s.getDropDownList(DropDownListDefines.ORDER_STATUS);e.then(function(e){"1"==e.code&&(this.orderStatusDropList=e.data,n.set(DropDownListDefines.ORDER_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getOrderObtanWayDropList=function(){if(this.orderObtanWayDropList=n.get(DropDownListDefines.ORDER_OBTAN_WAY),!this.mediaTypeResult){var e=s.getDropDownList(DropDownListDefines.ORDER_OBTAN_WAY);e.then(function(e){"1"==e.code&&(this.orderObtanWayDropList=e.data,n.set(DropDownListDefines.ORDER_OBTAN_WAY,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getOrderPayStatusDropList=function(){if(this.orderPayStatusDropList=n.get(DropDownListDefines.ORDER_PAY_STATUS),!this.mediaTypeResult){var e=s.getDropDownList(DropDownListDefines.ORDER_PAY_STATUS);e.then(function(e){"1"==e.code&&(this.orderPayStatusDropList=e.data,n.set(DropDownListDefines.ORDER_PAY_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.execute=function(){this.getOrderStatusDropList(),this.getOrderObtanWayDropList(),this.getOrderPayStatusDropList()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_ORDER_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function ExceptionOrderImportContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.execute=function(){this.getApproveStatus()},this.exceptionOrderUploader=UploaderUtil.create(o,{url:"http://"+window.location.host+ApiDefines.CPS_ORDER_IMPORT,formData:[{}],alias:"file",autoUpload:!0,filters:["xslFilter"],success:function(e){"1"==e.code?e.data.importResult?this.resultMessage="导入数据成功":(this.resultStatus=!0,this.resultMessage="导入数据失败,下载文件查看失败原因，",this.errorReasonFilePath=e.data.fileUrl):this.popAlert(e.message,"error")}.bind(this)}),this.downloadTemp=function(){window.open("http://"+window.location.host+ApiDefines.CPS_ORDER_DOWNLOAD_TEMP)},this.downErrorReasonFile=function(){window.open("http://"+window.location.host+ApiDefines.CPS_ORDER_DOWNLOAD_ERROR_FILE+this.errorReasonFilePath)},this.getApproveStatus=function(){if(this.approveStatusDropListResult=n.get(DropDownListDefines.ORDER_IMPORT_RESULT),!this.approveStatusDropListResult){var e=s.getDropDownList(DropDownListDefines.ORDER_IMPORT_RESULT);e.then(function(e){"1"==e.code&&(this.approveStatusDropListResult=e.data,n.set(DropDownListDefines.ORDER_IMPORT_RESULT,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CPS_ORDER_IMPORT_HIS,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function EditTemplateContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.error_message=0,this.execute=function(){t.data&&o.set("tempInfo",t.data.tempInfo,{exp:86400}),this.tempInfo=o.get("tempInfo")},this.editTemplateInstance=function(t,i){if(this.sumbmited=!0,""==t.content||null==t.content||void 0==t.content)return void(this.error_message=1);if(i){this.error_message=0;var s=ApiDefines.TEMPLATE_EDIT,o={entityDTO:{templateId:t.templateId,placeholder:t.placeholder,placeholderDesc:t.placeholderDesc,content:t.content}};n.post(s,o).then(function(t){1==t.code?(this.popAlert("保存成功","success"),e.go("main.allTemplate")):0==t.code?this.popAlert(t.message,"error"):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.back=function(){e.go("main.templateList")}}function HelpCenterAddContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.questionTypeResult={},this.errorMessageRequire=0,this.errorMessageLength=0,this.execute=function(){t.data&&(o.set("faqTypeId",t.data.faqTypeId,{exp:86400}),o.set("faqTypeName",t.data.faqTypeName,{exp:86400})),this.queryModel.entityDTO.faqTypeId=o.get("faqTypeId"),this.queryModel.entityDTO.faqTypeName=o.get("faqTypeName"),this.getQuestionType(),this.getCurrentSelectedUpdateDetails()},this.changed=function(){""==this.queryModel.entityDTO.answer||null==this.queryModel.entityDTO.answer?$("#contentErrorRequire").show():$("#contentErrorRequire").hide(),this.queryModel.entityDTO.answer.length>6500?$("#contentErrorLength").show():$("#contentErrorLength").hide()}.bind(this),this.saveQuestion=function(t){if(this.sumbmited=!0,this.queryModel.entityDTO.faqTypeId=o.get("faqTypeId"),""==this.queryModel.entityDTO.answer||null==this.queryModel.entityDTO.answer)return void(this.errorMessageRequire=1);if(this.errorMessageRequire=0,this.queryModel.entityDTO.answer.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){var i=n.post(ApiDefines.CREATE_QUESTION,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("问题创建成功","success"),e.go("main.helpCenterList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.getCurrentSelectedUpdateDetails=function(){if(null!==e.params.data&&(this.queryModel.entityDTO.faqTypeId=o.get("faqTypeId"),null!=this.queryModel.entityDTO.faqTypeId)){var t=n.post(ApiDefines.HELP_CENTER_GET_FAQDETAILS,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?this.queryModel.entityDTO=e.data:this.popAlert(e.message,"error")}.bind(this))}},this.getQuestionType=function(){if(this.questionTypeResult=o.get(DropDownListDefines.FAQ_TYPE),!this.questionTypeResult){var e=n.getDropDownList(DropDownListDefines.FAQ_TYPE);e.then(function(e){"1"==e.code&&(this.questionTypeResult=e.data,o.set(DropDownListDefines.FAQ_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.saveAddedCategory=function(t){if(this.sumbmited=!0,t){var i=n.post(ApiDefines.HELP_CENTER_ADD_CATEGORY,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("问题创建成功","success"),e.go("main.helpCenterList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.updateHelpCategory=function(i){if(this.sumbmited=!0,this.queryModel.entityDTO.faqTypeId=t.data.faqTypeId,i){var s=n.post(ApiDefines.HELP_CENTER_UPDATE_CATEGORY,angular.extend(this.queryModel));
s.then(function(t){"1"==t.code?(this.popAlert("问题创建成功","success"),e.go("main.helpCenterList"),this.queryModel={}):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.helpCenterList"),this.queryModel={}}}function HelpCenterListContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryQuestionListResult={},this.isHotquestionResult={},this.isLeafResult={},this.questionTypeResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.isHotQuestion(),this.getQuestionType()},this.addHelpCenter=function(t){var i=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;e.go("main.helpCenterAdd",{data:{faqTypeId:i,faqTypeName:t}});var s={name:"帮助中心",sref:"main.helpCenterList"};this.doActiveMenu(s)},this.addHelpCategory=function(){e.go("main.addHelpCategory",{data:{faqTypeId:null,faqTypeName:null}});var t={name:"帮助中心",sref:"main.helpCenterList"};this.doActiveMenu(t)},this.checkHotQuestion=function(){e.go("main.checkHotQuestion");var t={name:"帮助中心",sref:"main.helpCenterList"};this.doActiveMenu(t)},this.updateHelpCategory=function(){var t=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;e.go("main.updateHelpCategory",{data:{faqTypeId:t}});var i={name:"帮助中心",sref:"main.helpCenterList"};this.doActiveMenu(i)},this.updateHelpCenter=function(t){e.go("main.updateHelpCenter",{data:{faqId:t.faqId,faqTypeName:this.passfaqTypeName}});var i={name:"帮助中心",sref:"main.helpCenterList"};this.doActiveMenu(i)},this.reset=function(){this.queryModel={entityDTO:{}}},this.saveMessage=function(e){this.sumbmited=!0;var e=!0;if(""==this.queryModel.entityDTO.answer||null==this.queryModel.entityDTO.answer)return void(this.error_message_content=1);if(this.error_message_content=0,e){var t=s.post(ApiDefines.HELP_CENTER_MODIFY_SUMMARYCONTENT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?this.popAlert("消息创建成功","success"):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.helpCenterList")},this.deleteQuestionConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteSeCategoryConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteCategory=function(){this.deleteSeCategoryConfirm.opened=!0,this.deleteSeCategoryConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.faqTypeId=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;var t=s.post(ApiDefines.HELP_CENTER_DELTER_CATEGORY,angular.extend(this.queryModel));t.then(function(t){"1"==t.code?(this.popAlert("删除操作完成","success"),e.go(e.current,{},{reload:!0})):this.popAlert(t.message,"error")}.bind(this))}.bind(this)},this.deleteQuestion=function(e){this.deleteQuestionConfirm.opened=!0,this.deleteQuestionConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.faqId=e.faqId;var t=s.post(ApiDefines.DELETE_QUESTION,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.isHotQuestion=function(){if(this.isHotquestionResult=n.get(DropDownListDefines.FAQ_IS_HOT_QUESTION),this.isLeafResult=n.get(DropDownListDefines.FAQ_IS_HOT_QUESTION),!this.isHotquestionResult){var e=s.getDropDownList(DropDownListDefines.FAQ_IS_HOT_QUESTION);e.then(function(e){"1"==e.code&&(this.isHotquestionResult=e.data,this.isLeafResult=e.data,n.set(DropDownListDefines.FAQ_IS_HOT_QUESTION,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getQuestionType=function(){if(this.questionTypeResult=n.get(DropDownListDefines.FAQ_TYPE),!this.questionTypeResult){var e=s.getDropDownList(DropDownListDefines.FAQ_TYPE);e.then(function(e){"1"==e.code&&(this.questionTypeResult=e.data,n.set(DropDownListDefines.FAQ_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;if("undefined"!=i){this.queryModel.entityDTO.faqTypeId=i;var n=s.post(ApiDefines.HELP_CENTER_GET_FAQlIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"orderType"},{propertyName:"orderBy"}]},this.queryModel));n.then(function(e){"1"==e.code?(this.queryQuestionListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}}.bind(this),this.doPagingHotQuestionSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t),this.queryModel={entityDTO:{}};var i=s.post(ApiDefines.HELP_CENTER_GET_FAQHOTIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[{propertyName:"orderType"},{propertyName:"orderBy"}]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryQuestionListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getTreeViewRefresh=function(e){var t=s.post(ApiDefines.HELP_CENTER_TREEVIEW_NAME);t.then(function(t){if("1"==t.code){this.selectedViewTypescope=t.data;var i=angular.element(document.querySelector(".node-selected")).parent().parent(),s=angular.element(document.querySelector(".node-selected")).scope(),n=i.find(".node-selected").attr("data-nodeid");n="up"==e?parseInt(n)-1:parseInt(n)+1,i.treeview({data:this.selectedViewTypescope,onNodeSelected:function(e,t){void 0!=t.parentId&&(0==t.parentId||"概述"==t.text?(s.$parent.notSummary=!1,s.getsummaryContent(),s.$parent.disableUDbuttom=!0):(s.$parent.notSummary=!0,s.$parent.disableUDbuttom=!1,s.faqTypeId=t.faqTypeId,s.getfaqtypedetails(),s.getfaqtypelist()),s.$apply())}}),i.find("[data-nodeid="+n+"]").trigger("click")}else this.popAlert(t.message,"error")}.bind(this))}.bind(this),this.sortCategoryQuestion=function(e){var t=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;if(void 0!==t){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.orderAction=e,this.queryModel.entityDTO.faqTypeId=t;var i=s.post(ApiDefines.HELP_CENTER_SORT_FAQlIST,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.getTreeViewRefresh(e),this.popAlert("排序完成","success")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.sortQuestion=function(e,t){var i=angular.element(document.querySelector(".node-selected")).scope().faqTypeId;this.queryModel={entityDTO:{}},this.queryModel.entityDTO.faqId=t,this.queryModel.entityDTO.orderAction=e,this.queryModel.entityDTO.faqTypeId=i;var n=s.post(ApiDefines.SORT_QUESTION,angular.extend(this.queryModel));n.then(function(e){"1"==e.code?(this.doPagingSearch(this.index),this.popAlert("排序完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.saveAddedCategory=function(){}}function HelpCenterUpdateContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.questionTypeResult={},this.questionDetailResult={},this.errorMessageRequire=0,this.errorMessageLength=0,this.execute=function(){t.data&&(o.set("faqId",t.data.faqId,{exp:86400}),o.set("faqTypeName",t.data.faqTypeName,{exp:86400})),this.queryModel.entityDTO.faqId=o.get("faqId"),this.queryModel.entityDTO.faqTypeName=o.get("faqTypeName"),this.getQuestionType(),this.getQuestionDetail()},this.getQuestionType=function(){if(this.questionTypeResult=o.get(DropDownListDefines.FAQ_TYPE),!this.questionTypeResult){var e=n.getDropDownList(DropDownListDefines.FAQ_TYPE);e.then(function(e){"1"==e.code&&(this.questionTypeResult=e.data,o.set(DropDownListDefines.FAQ_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getQuestionDetail=function(){var e=n.post(ApiDefines.QUESTION_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.questionDetailResult=e.data,this.queryModel.entityDTO.type=e.data.type,this.queryModel.entityDTO.title=e.data.title,this.queryModel.entityDTO.answer=e.data.answer,this.queryModel.entityDTO.isHotQuestion=e.data.isHotQuestion)}.bind(this))}.bind(this),this.updateQuestion=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.answer||null==this.queryModel.entityDTO.answer)return void(this.errorMessageRequire=1);if(this.errorMessageRequire=0,this.queryModel.entityDTO.answer.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){var i=n.post(ApiDefines.UPDATE_QUESTION,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("问题修改成功","success"),e.go("main.helpCenterList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.helpCenterList")},this.changed=function(){""==this.queryModel.entityDTO.answer||null==this.queryModel.entityDTO.answer?$("#contentErrorRequire").show():$("#contentErrorRequire").hide(),this.queryModel.entityDTO.answer.length>6500?$("#contentErrorLength").show():$("#contentErrorLength").hide()}.bind(this)}function NoticeApproveContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.memberMessageDetailResult={},this.noticeTypeResult={},this.isSendMsgResult={},this.approveModel={entityDTO:{}},this.execute=function(){t.data&&o.set("noticeId",t.data.noticeId,{exp:86400}),this.queryModel.entityDTO.noticeId=o.get("noticeId"),this.approveModel.entityDTO.noticeId=o.get("noticeId"),this.getNoticeDetail(),this.isSendMsg(),this.getNoticeType()},this.isSendMsg=function(){if(this.isSendMsgResult=o.get(DropDownListDefines.NOTICE_IS_SEND_MSG),!this.isSendMsgResult){var e=n.getDropDownList(DropDownListDefines.NOTICE_IS_SEND_MSG);e.then(function(e){"1"==e.code&&(this.isSendMsgResult=e.data,o.set(DropDownListDefines.NOTICE_IS_SEND_MSG,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getNoticeType=function(){if(this.noticeTypeResult=o.get(DropDownListDefines.NOTICE_TYPE),!this.noticeTypeResult){var e=n.getDropDownList(DropDownListDefines.NOTICE_TYPE);e.then(function(e){"1"==e.code&&(this.noticeTypeResult=e.data,o.set(DropDownListDefines.NOTICE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getNoticeDetail=function(){var e=n.post(ApiDefines.NOTICE_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.memberMessageDetailResult=e.data)}.bind(this))}.bind(this),this.approveNotice=function(t){this.approveModel.entityDTO.approveResult=t;var i=n.post(ApiDefines.NOTICE_APPROVE,angular.extend(this.approveModel));i.then(function(t){"1"==t.code?(this.popAlert("审核操作已完成","success"),e.go("main.notificationList")):this.popAlert(t.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.notificationList");var t={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(t)}}function NoticeCreateContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.errorMessageRequire=0,this.errorMessageLength=0,this.execute=function(){},this.changed=function(){""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content?$("#contentErrorRequire").show():$("#contentErrorRequire").hide(),this.queryModel.entityDTO.content.length>6500?$("#contentErrorLength").show():$("#contentErrorLength").hide()}.bind(this),this.saveNotice=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.errorMessageRequire=1);if(this.errorMessageRequire=0,this.queryModel.entityDTO.content.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){1==this.queryModel.entityDTO.isSendMsg?this.queryModel.entityDTO.isSendMsg=1:this.queryModel.entityDTO.isSendMsg=0;var i=s.post(ApiDefines.CREATE_NOTICE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("公告创建成功","success"),e.go("main.notificationList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.saveAndAskApprove=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.errorMessageRequire=1);if(this.queryModel.entityDTO.content.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){1==this.queryModel.entityDTO.isSendMsg?this.queryModel.entityDTO.isSendMsg=1:this.queryModel.entityDTO.isSendMsg=0,this.queryModel.entityDTO.requestLocation=2;var i=s.post(ApiDefines.SAVE_AND_ASK_APPROVE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("公告创建成功并已提交审核","success"),e.go("main.notificationList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.notificationList");var t={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(t)}}function NoticeUpdateContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.errorMessageRequire=0,this.execute=function(){t.data&&o.set("noticeId",t.data.noticeId,{exp:86400}),this.queryModel.entityDTO.noticeId=o.get("noticeId"),this.getNoticeDetail()},this.changed=function(){""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content?$("#contentError").show():$("#contentError").hide(),this.queryModel.entityDTO.content.length>6500?$("#contentErrorLength").show():$("#contentErrorLength").hide()}.bind(this),this.getNoticeDetail=function(){var e=n.post(ApiDefines.NOTICE_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.memberMessageDetailResult=e.data,this.queryModel.entityDTO.title=e.data.title,this.queryModel.entityDTO.type=e.data.type,this.queryModel.entityDTO.content=e.data.content,this.queryModel.entityDTO.isSendMsg=e.data.isSendMsg,1==this.queryModel.entityDTO.isSendMsg&&(this.queryModel.entityDTO.isSendMsg=!0))}.bind(this))}.bind(this),this.updateNotice=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.errorMessageRequire=1);if(this.errorMessageRequire=0,this.queryModel.entityDTO.content.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){1==this.queryModel.entityDTO.isSendMsg?this.queryModel.entityDTO.isSendMsg=1:this.queryModel.entityDTO.isSendMsg=0;var i=n.post(ApiDefines.UPDATE_NOTICE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("公告修改成功","success"),e.go("main.notificationList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.saveAndAskApprove=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.errorMessageRequire=1);if(this.errorMessageRequire=0,this.queryModel.entityDTO.content.length>6500)return void(this.errorMessageLength=1);if(this.errorMessageLength=0,t){1==this.queryModel.entityDTO.isSendMsg?this.queryModel.entityDTO.isSendMsg=1:this.queryModel.entityDTO.isSendMsg=0,this.queryModel.entityDTO.requestLocation=1;var i=n.post(ApiDefines.SAVE_AND_ASK_APPROVE,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("公告已提交审核","success"),e.go("main.notificationList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.notificationList");var t={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(t)}}function NotificationListContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.noticeStatusResult={},this.noticeTypeResult={},this.queryNoticeListResult={},this.isSendMsgResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.roleCode=UserUtil.getUserRole(),this.getNoticeStatus(),this.isSendMsg(),this.getNoticeType(),t.data&&(this.queryModel.entityDTO.status=t.data.status,t.data.status=null)},this.updateNotice=function(t){e.go("main.updateNotification",{data:{noticeId:t.noticeId}});var i={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(i)},this.viewNotice=function(t){e.go("main.viewNotification",{data:{noticeId:t.noticeId}});var i={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(i)},this.goApprove=function(t){e.go("main.approveNotification",{data:{noticeId:t.noticeId}});var i={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(i)},this.addNotification=function(){e.go("main.addNotification");var t={name:"页面管理",sref:"main.notificationManagement"};this.doActiveMenu(t)},this.getNoticeStatus=function(){if(this.noticeStatusResult=o.get(DropDownListDefines.NOTICE_STATUS),!this.noticeStatusResult){var e=n.getDropDownList(DropDownListDefines.NOTICE_STATUS);e.then(function(e){"1"==e.code&&(this.noticeStatusResult=e.data,o.set(DropDownListDefines.NOTICE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.isSendMsg=function(){if(this.isSendMsgResult=o.get(DropDownListDefines.NOTICE_IS_SEND_MSG),!this.isSendMsgResult){var e=n.getDropDownList(DropDownListDefines.NOTICE_IS_SEND_MSG);e.then(function(e){"1"==e.code&&(this.isSendMsgResult=e.data,o.set(DropDownListDefines.NOTICE_IS_SEND_MSG,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getNoticeType=function(){if(this.noticeTypeResult=o.get(DropDownListDefines.NOTICE_TYPE),!this.noticeTypeResult){var e=n.getDropDownList(DropDownListDefines.NOTICE_TYPE);e.then(function(e){"1"==e.code&&(this.noticeTypeResult=e.data,o.set(DropDownListDefines.NOTICE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.deleteNoticeConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteNotice=function(e){this.deleteNoticeConfirm.opened=!0,this.deleteNoticeConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.noticeId=e.noticeId;var t=n.post(ApiDefines.DELETE_NOTICE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.askForApproveConfirm={opened:!1,ok:void 0,cancel:void 0},this.askForApprove=function(e){this.askForApproveConfirm.opened=!0,this.askForApproveConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.noticeId=e.noticeId;var t=n.post(ApiDefines.ASK_FOR_APPROVE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("提交审核操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.offLineConfirm={opened:!1,ok:void 0,cancel:void 0},this.offLine=function(e){this.offLineConfirm.opened=!0,this.offLineConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.noticeId=e.noticeId;var t=n.post(ApiDefines.OFF_LINE,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("下线操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.sortNotice=function(e,t){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.noticeId=t,this.queryModel.entityDTO.orderAction=e;var i=n.post(ApiDefines.SORT_NOTICE,angular.extend(this.queryModel));i.then(function(e){"1"==e.code?(this.doPagingSearch(this.index),this.popAlert("排序完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.NOTICE_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryNoticeListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}}}function TemplateListContext(e,t,i,s){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.error_message=0,this.execute=function(){},this.addTemplate=function(){e.go("main.addTemplate");var t={name:"模板管理",sref:"main.templateList"};this.doActiveMenu(t)},this.goAllTemplate=function(){e.go("main.allTemplate");var t={name:"模板管理",sref:"main.templateList"};this.doActiveMenu(t)},this.goSystemTemplate=function(){e.go("main.systemTemplate");var t={name:"模板管理",sref:"main.templateList"};this.doActiveMenu(t)},this.goUserTemplate=function(){e.go("main.userTemplate");var t={name:"模板管理",sref:"main.templateList"};this.doActiveMenu(t)},this.editTemplate=function(t){e.go("main.editTemplate",{data:{tempInfo:t}});var i={name:"模板管理",sref:"main.templateList"};this.doActiveMenu(i)},this.deleteTemplateConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteTemplate=function(e){this.deleteTemplateConfirm.opened=!0,this.deleteTemplateConfirm.ok=function(){var t=ApiDefines.TEMPLATE_DELETE,i={entityDTO:{templateId:e.templateId}};s.post(t,i).then(function(e){1==e.code?(this.doPagingSearch(this.pageIndex),this.popAlert(e.message,"success")):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.TEMPLATE_QUERY,n={entityDTO:{},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex}};s.post(i,n).then(function(e){1==e.code?(this.searchedTemplateList=e.data.records,this.totalPages=e.data.pageDTO.totalCount,this.pageIndex=e.data.pageDTO.pageNo):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.doPagingSearchSystem=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.TEMPLATE_QUERY,n={entityDTO:{type:0},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex}};s.post(i,n).then(function(e){1==e.code?(this.searchedSystemTemplateList=e.data.records,this.totalPagesSystem=e.data.pageDTO.totalCount,this.pageIndexSystem=e.data.pageDTO.pageNo):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.doPagingSearchUser=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=ApiDefines.TEMPLATE_QUERY,n={entityDTO:{type:1},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex}};s.post(i,n).then(function(e){1==e.code?(this.searchedUserTemplateList=e.data.records,this.totalPagesUser=e.data.pageDTO.totalCount,this.pageIndexUser=e.data.pageDTO.pageNo):0==e.code?this.popAlert(e.message,"error"):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.addTemplateInstance=function(t){if(this.sumbmited=!0,""==this.queryModel.entityDTO.content||void 0==this.queryModel.entityDTO.content||null==this.queryModel.entityDTO.content)return void(this.error_message=1);if(t){this.error_message=0;var i=ApiDefines.TEMPLATE_ADD,n=this.queryModel;s.post(i,n).then(function(t){1==t.code?(this.popAlert("保存成功","success"),e.go("main.allTemplate")):0==t.code?this.popAlert(t.message,"error"):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.back=function(){e.go("main.templateList")}}function AdActivitiesAddContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.activityTypeDropListResult={},this.promoteTypeDropListResult={},this.approveMethodDropListResult={},this.contentTypeDropListResult={},this.materialList=[],this.activityMaterialId=[],this.viewModel={entityDTO:{}},this.picMaterialUploader=UploaderUtil.create(o,{url:appConfig.apiPath+ApiDefines.ADD_ACTIVITY_MATERIAL,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.materialList.push(e.data),this.activityMaterialId.push(e.data.materialId)):this.popAlert(e.message,"error")}.bind(this)}),this.activityLogoUploader=UploaderUtil.create(o,{url:n.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.popAlert("文件上传成功","success"),this.queryModel.entityDTO.activityLogo=e.fileUrl):this.popAlert(e.message,"error")}.bind(this)}),this.picMaterialUpdateUploader=UploaderUtil.create(o,{url:appConfig.apiPath+ApiDefines.UPDATE_ACTIVITY_MATERIAL,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?this.popAlert("文件上传成功","success"):this.popAlert(e.message,"error")}.bind(this)}),this.submitUpLoader=function(e){this.picMaterialUpdateUploader.formData=[{materialId:e}]},this.removeMaterial=function(e){var t=this.materialList.indexOf(e);t!=-1&&this.materialList.splice(t,1),this.removeMaterialId(e.materialId)},this.removeMaterialId=function(e){var t=this.activityMaterialId.indexOf(e);t!=-1&&this.activityMaterialId.splice(t,1)},this.preview=function(e){this.viewModel.entityDTO={isTmpPic:!1,picUrl:e};var t=s.post(n.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));t.then(function(e){"1"==e.code?(this.viewPicture=ModalUtil.createModal(a,ModalPath.VIEW_PICTURE,this,"md"),this.src=e.data.pictureData):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.execute=function(){this.getActivityType(),this.getActivityPromoteType(),this.getApproveMethod(),this.getContentType()},this.saveAdActivity=function(t){if(this.sumbmited=!0,t){1==this.queryModel.entityDTO.contentType&&(this.queryModel.entityDTO.activityMaterialIdList=this.activityMaterialId);var i=s.post(ApiDefines.ADD_ACTIVITY,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("广告活动创建成功","success"),e.go("main.adActiveList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.getApproveMethod=function(){if(this.approveMethodDropListResult=n.get(DropDownListDefines.APPROVE_METHOD),!this.approveMethodDropListResult){var e=s.getDropDownList(DropDownListDefines.APPROVE_METHOD);e.then(function(e){"1"==e.code&&(this.approveMethodDropListResult=e.data,n.set(DropDownListDefines.APPROVE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getContentType=function(){if(this.contentTypeDropListResult=n.get(DropDownListDefines.CONTENT_TYPE),!this.contentTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.CONTENT_TYPE);e.then(function(e){"1"==e.code&&(this.contentTypeDropListResult=e.data,n.set(DropDownListDefines.CONTENT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityPromoteType=function(){if(this.promoteTypeDropListResult=n.get(DropDownListDefines.PROMOTE_TYPE),!this.promoteTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.PROMOTE_TYPE);e.then(function(e){"1"==e.code&&(this.promoteTypeDropListResult=e.data,n.set(DropDownListDefines.PROMOTE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityType=function(){if(this.activityTypeDropListResult=n.get(DropDownListDefines.ACTIVITY_TYPE),!this.activityTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.ACTIVITY_TYPE);e.then(function(e){"1"==e.code&&(this.activityTypeDropListResult=e.data,n.set(DropDownListDefines.ACTIVITY_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.adActiveList");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.reset=function(){this.queryModel={entityDTO:{}}}}function AdActivitiesAuditContext(e,t,i,s,n,o,a){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.activityStatusDropListResult={},this.activityTypeDropListResult={},this.promoteTypeDropListResult={},this.approveMethodDropListResult={},this.contentTypeDropListResult={},this.acitivityDetailResult={},this.queryActivityMaterialListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.viewModel={entityDTO:{}},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){t.data&&(o.set("activityId",t.data.activityId,{exp:86400}),o.set("activityStatus",t.data.activityStatus,{exp:86400})),this.queryModel.entityDTO.activityId=o.get("activityId"),this.query.entityDTO.activityId=o.get("activityId"),this.queryModel.entityDTO.activityStatus=o.get("activityStatus"),this.getActivityType(),this.getActivityPromoteType(),this.getApproveMethod(),this.getContentType(),this.getActivityDetail()},this.preview=function(){this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.activityLogo};var e=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));e.then(function(e){"1"==e.code?(this.viewPicture=ModalUtil.createModal(a,ModalPath.VIEW_PICTURE,this,"md"),this.src=e.data.pictureData):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getApproveMethod=function(){if(this.approveMethodDropListResult=o.get(DropDownListDefines.APPROVE_METHOD),!this.approveMethodDropListResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_METHOD);e.then(function(e){"1"==e.code&&(this.approveMethodDropListResult=e.data,o.set(DropDownListDefines.APPROVE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getContentType=function(){if(this.contentTypeDropListResult=o.get(DropDownListDefines.CONTENT_TYPE),!this.contentTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.CONTENT_TYPE);e.then(function(e){"1"==e.code&&(this.contentTypeDropListResult=e.data,o.set(DropDownListDefines.CONTENT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityPromoteType=function(){if(this.promoteTypeDropListResult=o.get(DropDownListDefines.PROMOTE_TYPE),!this.promoteTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.PROMOTE_TYPE);e.then(function(e){"1"==e.code&&(this.promoteTypeDropListResult=e.data,o.set(DropDownListDefines.PROMOTE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityType=function(){if(this.activityTypeDropListResult=o.get(DropDownListDefines.ACTIVITY_TYPE),!this.activityTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_TYPE);e.then(function(e){"1"==e.code&&(this.activityTypeDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityDetail=function(){var e=n.post(ApiDefines.ACTIVITY_DETAIL,angular.extend(this.queryModel));e.then(function(e){if("1"==e.code){this.acitivityDetailResult=e.data,this.activityLogo=e.data.activityLogo;var t=e.data.updateColumns;void 0!=t&&t.length>0&&t.forEach(function(e,t){$("."+e).css("color","red")}),void 0!=t&&t.length>0&&(this.updatedColumnList=t)}}.bind(this))}.bind(this),this.checkColumnInList=function(e){var t=!1;if(this.updatedColumnList)for(var i=0;i<this.updatedColumnList.length;i++)if(this.updatedColumnList[i]==e){t=!0;break}return t},this.approvePass=function(t){this.queryModel.entityDTO.approveResult=t,this.queryModel.entityDTO.activityId=o.get("activityId");var i=n.post(ApiDefines.APPROVE_ACTIVITY_INFO,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("审核操作已完成","success"),e.go("main.adActiveList")):this.popAlert(t.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.adActiveList");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.ACTIVITY_MATERIAL_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.query));i.then(function(e){"1"==e.code?(this.queryActivityMaterialListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}function AdActivitiesListContext(e,t,i,s,n,o){this.queryModel={entityDTO:{}},this.activityStatusDropListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.queryAdvertisementListResult={},this.activityTypeDropListResult={},this.promoteTypeDropListResult={},
this.approveMethodDropListResult={},this.approveStatusDropListResult={},this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){this.getActivityPromoteType(),this.getActivityStatus(),this.getActivityType(),this.getApproveMethod(),this.getApproveStatus(),this.roleCode=UserUtil.getUserRole(),"OE"==this.roleCode&&(this.queryModel.entityDTO.activityStatus="1"),t.data&&(this.queryModel.entityDTO.activityStatus=t.data.status)},this.getActivityPromoteType=function(){if(this.promoteTypeDropListResult=o.get(DropDownListDefines.PROMOTE_TYPE),!this.promoteTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.PROMOTE_TYPE);e.then(function(e){"1"==e.code&&(this.promoteTypeDropListResult=e.data,o.set(DropDownListDefines.PROMOTE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityStatus=function(){if(this.activityStatusDropListResult=o.get(DropDownListDefines.ACTIVITY_STATUS),!this.activityStatusDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_STATUS);e.then(function(e){"1"==e.code&&(this.activityStatusDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityType=function(){if(this.activityTypeDropListResult=o.get(DropDownListDefines.ACTIVITY_TYPE),!this.activityTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_TYPE);e.then(function(e){"1"==e.code&&(this.activityTypeDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getApproveMethod=function(){if(this.approveMethodDropListResult=o.get(DropDownListDefines.APPROVE_METHOD),!this.approveMethodDropListResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_METHOD);e.then(function(e){"1"==e.code&&(this.approveMethodDropListResult=e.data,o.set(DropDownListDefines.APPROVE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getApproveStatus=function(){if(this.approveStatusDropListResult=o.get(DropDownListDefines.ACTIVITY_APPROVE_STATUS),!this.approveStatusDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_APPROVE_STATUS);e.then(function(e){"1"==e.code&&(this.approveStatusDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_APPROVE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}},this.goAdActivityAdd=function(){e.go("main.adActivityAdd");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.viewAdActivity=function(t){e.go("main.adActivityView",{data:{activityId:t.activityId,activityStatus:t.activityStatus}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.publishAdActivityConfirm={opened:!1,ok:void 0,cancel:void 0},this.publishAdActivity=function(e){this.publishAdActivityConfirm.opened=!0,this.publishAdActivityConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.activityId=e.activityId;var t=n.post(ApiDefines.PUBLISH_ACTIVITY,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("发布操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.puaseAdActivityConfirm={opened:!1,ok:void 0,cancel:void 0},this.puaseAdActivity=function(e){this.puaseAdActivityConfirm.opened=!0,this.puaseAdActivityConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.activityId=e.activityId;var t=n.post(ApiDefines.PUASE_ACTIVITY,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("暂停操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.auditAdActivity=function(t){e.go("main.adActivityAudit",{data:{activityId:t.activityId,activityStatus:t.activityStatus}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.ADVERTISEMENT_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.queryModel));i.then(function(e){"1"==e.code?(this.queryAdvertisementListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.deleteAdActivityConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteAdActivity=function(e){this.deleteAdActivityConfirm.opened=!0,this.deleteAdActivityConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.activityId=e.activityId;var t=n.post(ApiDefines.DELETE_ADACTIVITY,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.subitToAuditConfirm={opened:!1,ok:void 0,cancel:void 0},this.sumbitToAudit=function(e){this.subitToAuditConfirm.opened=!0,this.subitToAuditConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.activityId=e.activityId;var t=n.post(ApiDefines.SUMBIT_TO_AUDIT,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("提交审核操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.updateAdActivity=function(t){e.go("main.adActivityUpdate",{data:{activityId:t.activityId,activityStatus:t.activityStatus}});var i={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(i)}}function AdActivitiesUpdateContext(e,t,i,s,n,o,a,r){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.viewModel={entityDTO:{}},this.activityStatusDropListResult={},this.activityTypeDropListResult={},this.promoteTypeDropListResult={},this.approveMethodDropListResult={},this.contentTypeDropListResult={},this.approveStatusDropListResult={},this.queryActivityMaterialListResult=[],this.activityMaterialId=[],this.updateColumnList=[],this.pageSize=20,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.picMaterialUploader=UploaderUtil.create(a,{url:appConfig.apiPath+ApiDefines.ADD_ACTIVITY_MATERIAL,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(e.data.tmpFlag=!0,this.queryActivityMaterialListResult.push(e.data),this.activityMaterialId.push(e.data.materialId),this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.picMaterialUpdateUploader=UploaderUtil.create(a,{url:appConfig.apiPath+ApiDefines.UPDATE_ACTIVITY_MATERIAL,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?this.popAlert("文件上传成功","success"):this.popAlert(e.message,"error")}.bind(this)}),this.removeMaterial=function(e){e.tmpFlag||this.deleteActivityMaterial(e);var t=this.queryActivityMaterialListResult.indexOf(e);t!=-1&&this.queryActivityMaterialListResult.splice(t,1),this.removeMaterialId(e.materialId)},this.removeMaterialId=function(e){var t=this.activityMaterialId.indexOf(e);t!=-1&&this.activityMaterialId.splice(t,1)},this.deleteActivityMaterialConfirm={opened:!1,ok:void 0,cancel:void 0},this.deleteActivityMaterial=function(e){this.deleteActivityMaterialConfirm.opened=!0,this.deleteActivityMaterialConfirm.ok=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.materialId=e.materialId;var t=n.post(ApiDefines.DELETE_ADACTIVITY_MATERIAL,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?(this.doPagingSearch(1),this.popAlert("删除操作完成","success")):this.popAlert(e.message,"error")}.bind(this))}.bind(this)},this.preview=function(e,t){this.viewModel.entityDTO={isTmpPic:!1,picUrl:t};var i=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));i.then(function(e){"1"==e.code?(this.viewPicture=ModalUtil.createModal(r,ModalPath.VIEW_PICTURE,this,"md"),this.src=e.data.pictureData):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.unique=function(e){for(var t,i=[],s={},n=0;null!=(t=e[n]);n++)s[t]||(i.push(t),s[t]=!0);return i},this.addUpdateColumnList=function(e){this.updateColumnList.push(e),this.updateColumnList=this.unique(this.updateColumnList)},this.updateAdActivity=function(t){if(this.sumbmited=!0,t){1==this.queryModel.entityDTO.contentType&&(this.queryModel.entityDTO.activityMaterialIdList=this.activityMaterialId),void 0!=this.queryModel.entityDTO.activityLogo&&this.addUpdateColumnList("activityLogo"),this.queryModel.entityDTO.updateColumnList=this.updateColumnList;var i=n.post(ApiDefines.UPDATE_ACTIVITY,angular.extend(this.queryModel));i.then(function(t){"1"==t.code?(this.popAlert("修改申请已提交","success"),e.go("main.adActiveList")):this.popAlert(t.message,"error")}.bind(this))}}.bind(this),this.submitUpLoader=function(e){this.picMaterialUpdateUploader.formData=[{materialId:e,activityId:this.queryModel.entityDTO.activityId}]},this.activityLogoUploader=UploaderUtil.create(a,{url:o.get("FILE_SERVER_PATH")+ApiDefines.UPLOAD_IMG_FILE,formData:[{}],alias:"file",autoUpload:!0,filters:["imgFilter"],success:function(e){"1"==e.code?(this.queryModel.entityDTO.activityLogo=e.fileUrl,this.popAlert("文件上传成功","success")):this.popAlert(e.message,"error")}.bind(this)}),this.execute=function(){t.data&&(o.set("activityId",t.data.activityId,{exp:86400}),o.set("activityStatus",t.data.activityStatus,{exp:86400})),this.queryModel.entityDTO.activityId=o.get("activityId"),this.queryModel.entityDTO.activityStatus=o.get("activityStatus"),this.query.entityDTO.activityId=o.get("activityId"),this.getActivityType(),this.getActivityPromoteType(),this.getApproveMethod(),this.getContentType(),this.getApproveStatus(),this.getActivityStatus(),this.getActivityDetail(),this.doPagingSearch()},this.getApproveMethod=function(){if(this.approveMethodDropListResult=o.get(DropDownListDefines.APPROVE_METHOD),!this.approveMethodDropListResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_METHOD);e.then(function(e){"1"==e.code&&(this.approveMethodDropListResult=e.data,o.set(DropDownListDefines.APPROVE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getContentType=function(){if(this.contentTypeDropListResult=o.get(DropDownListDefines.CONTENT_TYPE),!this.contentTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.CONTENT_TYPE);e.then(function(e){"1"==e.code&&(this.contentTypeDropListResult=e.data,o.set(DropDownListDefines.CONTENT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityPromoteType=function(){if(this.promoteTypeDropListResult=o.get(DropDownListDefines.PROMOTE_TYPE),!this.promoteTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.PROMOTE_TYPE);e.then(function(e){"1"==e.code&&(this.promoteTypeDropListResult=e.data,o.set(DropDownListDefines.PROMOTE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityType=function(){if(this.activityTypeDropListResult=o.get(DropDownListDefines.ACTIVITY_TYPE),!this.activityTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_TYPE);e.then(function(e){"1"==e.code&&(this.activityTypeDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityStatus=function(){if(this.activityStatusDropListResult=o.get(DropDownListDefines.ACTIVITY_STATUS),!this.activityStatusDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_STATUS);e.then(function(e){"1"==e.code&&(this.activityStatusDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getApproveStatus=function(){if(this.approveStatusDropListResult=o.get(DropDownListDefines.ACTIVITY_APPROVE_STATUS),!this.approveStatusDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_APPROVE_STATUS);e.then(function(e){"1"==e.code&&(this.approveStatusDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_APPROVE_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityDetail=function(){var e=n.post(ApiDefines.ACTIVITY_DETAIL,angular.extend(this.queryModel));e.then(function(e){"1"==e.code&&(this.acitivityDetailResult=e.data,this.activityLogo=e.data.activityLogo,this.queryModel.entityDTO.name=e.data.name,this.queryModel.entityDTO.startDate=e.data.startDate,this.queryModel.entityDTO.endDate=e.data.endDate,this.queryModel.entityDTO.activityIntruduce=e.data.activityIntruduce,this.queryModel.entityDTO.contentName=e.data.contentName,this.queryModel.entityDTO.contentType=e.data.contentType,this.queryModel.entityDTO.promoteUrl=e.data.promoteUrl,this.queryModel.entityDTO.remark=e.data.remark,this.queryModel.entityDTO.activityType=e.data.activityType,this.queryModel.entityDTO.promoteType=e.data.promoteType,this.queryModel.entityDTO.approveMethod=e.data.approveMethod,this.queryModel.entityDTO.promoteText=e.data.promoteText)}.bind(this))}.bind(this),this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.ACTIVITY_MATERIAL_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.query));i.then(function(e){if("1"==e.code){this.queryActivityMaterialListResult=e.data.records;for(var t=0;t<this.queryActivityMaterialListResult.length;t++)this.queryActivityMaterialListResult[t].tmpFlag=!1,this.activityMaterialId.push(this.queryActivityMaterialListResult[t].materialId);this.totalPages=e.data.pageDTO.totalCount}else this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.goBack=function(){e.go("main.adActiveList");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.reset=function(){this.queryModel={entityDTO:{}}}}function AdActivitiesViewContext(e,t,i,s,n,o,a,r){this.queryModel={entityDTO:{}},this.query={entityDTO:{}},this.activityStatusDropListResult={},this.activityTypeDropListResult={},this.promoteTypeDropListResult={},this.approveMethodDropListResult={},this.contentTypeDropListResult={},this.acitivityDetailResult={},this.viewModel={entityDTO:{}},this.queryActivityMaterialListResult={},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.orderUtil={orderDTOs:[{propertyName:"createDate",type:"desc"}],order:[],trigger:this.doPagingSearch},this.execute=function(){t.data&&(o.set("activityId",t.data.activityId,{exp:86400}),o.set("activityStatus",t.data.activityStatus,{exp:86400})),this.queryModel.entityDTO.activityId=o.get("activityId"),this.query.entityDTO.activityId=o.get("activityId"),this.queryModel.entityDTO.activityStatus=o.get("activityStatus"),this.getActivityType(),this.getActivityPromoteType(),this.getApproveMethod(),this.getContentType(),this.getActivityDetail()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=n.post(ApiDefines.ACTIVITY_MATERIAL_LIST,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:this.orderUtil.orderDTOs},this.query));i.then(function(e){"1"==e.code?(this.queryActivityMaterialListResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getApproveMethod=function(){if(this.approveMethodDropListResult=o.get(DropDownListDefines.APPROVE_METHOD),!this.approveMethodDropListResult){var e=n.getDropDownList(DropDownListDefines.APPROVE_METHOD);e.then(function(e){"1"==e.code&&(this.approveMethodDropListResult=e.data,o.set(DropDownListDefines.APPROVE_METHOD,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getContentType=function(){if(this.contentTypeDropListResult=o.get(DropDownListDefines.CONTENT_TYPE),!this.contentTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.CONTENT_TYPE);e.then(function(e){"1"==e.code&&(this.contentTypeDropListResult=e.data,o.set(DropDownListDefines.CONTENT_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityPromoteType=function(){if(this.promoteTypeDropListResult=o.get(DropDownListDefines.PROMOTE_TYPE),!this.promoteTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.PROMOTE_TYPE);e.then(function(e){"1"==e.code&&(this.promoteTypeDropListResult=e.data,o.set(DropDownListDefines.PROMOTE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getActivityType=function(){if(this.activityTypeDropListResult=o.get(DropDownListDefines.ACTIVITY_TYPE),!this.activityTypeDropListResult){var e=n.getDropDownList(DropDownListDefines.ACTIVITY_TYPE);e.then(function(e){"1"==e.code&&(this.activityTypeDropListResult=e.data,o.set(DropDownListDefines.ACTIVITY_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.goBack=function(){e.go("main.adActiveList");var t={name:"推广管理",sref:"main.adActiveList"};this.doActiveMenu(t)},this.preview=function(){this.viewModel.entityDTO={isTmpPic:!1,picUrl:this.activityLogo};var e=n.post(o.get("FILE_SERVER_PATH")+ApiDefines.PREVIEW_IMAGE,angular.extend(this.viewModel));e.then(function(e){"1"==e.code?(this.viewPicture=ModalUtil.createModal(r,ModalPath.VIEW_PICTURE,this,"md"),this.src=e.data.pictureData):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.getActivityDetail=function(){var e=n.post(ApiDefines.ACTIVITY_DETAIL,angular.extend(this.queryModel));e.then(function(e){if("1"==e.code){this.acitivityDetailResult=e.data,this.activityLogo=e.data.activityLogo;var t=e.data.updateColumns;void 0!=t&&t.length>0&&t.forEach(function(e,t){$("."+e).css("color","red")}),void 0!=t&&t.length>0&&(this.updatedColumnList=t)}}.bind(this))}.bind(this),this.checkColumnInList=function(e){var t=!1;if(this.updatedColumnList)for(var i=0;i<this.updatedColumnList.length;i++)if(this.updatedColumnList[i]==e){t=!0;break}return t}}function PromotionDetailReportContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.pageSize=PageConfig.INIT_PAGE_SIZE,this.pageIndex=PageConfig.INIT_PAGE_INDEX,this.orderStatusResult={},this.payStatusResult={},this.settlementStatusResult={},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i=s.post(ApiDefines.CHANNEL_MARKET_DETAILS,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));i.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reportExport=function(){var e=s.post(ApiDefines.CHANNEL_MARKET_DETAILS_EXPORT,angular.extend(this.queryModel));e.then(function(e){"1"==e.code?window.open(n.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_DOWN+"?downFileName="+e.data.downFileName):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}}},this.getOrderStatus=function(){if(this.orderStatusResult=n.get(DropDownListDefines.ORDER_STATUS),!this.orderStatusResult){var e=s.getDropDownList(DropDownListDefines.ORDER_STATUS);e.then(function(e){"1"==e.code&&(this.orderStatusResult=e.data,n.set(DropDownListDefines.ORDER_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getPayStatus=function(){if(this.payStatusResult=n.get(DropDownListDefines.ORDER_PAY_STATUS),!this.payStatusResult){var e=s.getDropDownList(DropDownListDefines.ORDER_PAY_STATUS);e.then(function(e){"1"==e.code&&(this.payStatusResult=e.data,n.set(DropDownListDefines.ORDER_PAY_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getSettlementStatus=function(){if(this.settlementStatusResult=n.get(DropDownListDefines.ORDER_SETTLEMENT_STATUS),!this.settlementStatusResult){var e=s.getDropDownList(DropDownListDefines.ORDER_SETTLEMENT_STATUS);e.then(function(e){"1"==e.code&&(this.settlementStatusResult=e.data,n.set(DropDownListDefines.ORDER_SETTLEMENT_STATUS,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getEncourageTypeDropList=function(){if(this.encourageTypeDropListResult=n.get(DropDownListDefines.ENCOURAGE_TYPE),!this.encourageTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.ENCOURAGE_TYPE);e.then(function(e){"1"==e.code&&(this.encourageTypeDropListResult=e.data,n.set(DropDownListDefines.ENCOURAGE_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getCategory=function(){var e=ApiDefines.CPS_TYPE_LIST,t={entityDTO:{},pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]};s.post(e,t).then(function(e){this.categoryArr=e.data.records}.bind(this))}.bind(this),this.execute=function(){this.getEncourageTypeDropList(),this.getOrderStatus(),this.getPayStatus(),this.getSettlementStatus(),this.getCategory()}}function PromotionEffectReportContext(e,t,i,s,n){this.queryModel={entityDTO:{}},this.displayMethod=1,this.mediaTypeDropListResult={},this.memberTypeDropListResult={},this.dropDownCodeListResult={},this.getMediaType=function(){if(this.mediaTypeDropListResult=n.get(DropDownListDefines.MEDIA_TYPE),!this.mediaTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.MEDIA_TYPE);e.then(function(e){"1"==e.code&&(this.mediaTypeDropListResult=e.data,n.set(DropDownListDefines.MEDIA_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getMemberType=function(){if(this.memberTypeDropListResult=n.get(DropDownListDefines.MEMBER_TYPE),!this.memberTypeDropListResult){var e=s.getDropDownList(DropDownListDefines.MEMBER_TYPE);e.then(function(e){"1"==e.code&&(this.memberTypeDropListResult=e.data,n.set(DropDownListDefines.MEMBER_TYPE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.getProductType=function(){}.bind(this),this.getCodeDropList=function(){if(this.dropDownCodeListResult=n.get(DropDownListDefines.DROP_DOWN_CODE),!this.dropDownCodeListResult){var e=s.getDropDownList(DropDownListDefines.DROP_DOWN_CODE);e.then(function(e){"1"==e.code&&(this.dropDownCodeListResult=e.data,n.set(DropDownListDefines.DROP_DOWN_CODE,e.data,{exp:Constants.EXP_TIME}))}.bind(this))}}.bind(this),this.reset=function(){this.queryModel={entityDTO:{}},this.queryModel.entityDTO.dropDownCode="1"},this.getProductType=function(){var e=ApiDefines.CPS_TYPE_LIST,t={entityDTO:{},pageDTO:{pageSize:PageConfig.INIT_PAGE_SIZE,pageNo:PageConfig.INIT_PAGE_INDEX},orderDTOs:[]};s.post(e,t).then(function(e){1==e.code?this.productTypeDropListResult=e.data.records:this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.execute=function(){this.getMediaType(),this.getMemberType(),this.getProductType(),this.getCodeDropList(),this.queryModel.entityDTO.dropDownCode="1",this.getProductType()},this.doPagingSearch=function(e,t){"undefined"!=typeof e&&(this.pageIndex=e),"undefined"!=typeof t&&(this.pageSize=t);var i="";i=1==this.displayMethod?ApiDefines.CHANNEL_MARKET_EFFECT_TIME_VIEW:ApiDefines.CHANNEL_MARKET_EFFECT_MEDIA_VIEW;var n=s.post(i,angular.extend({pageDTO:{pageSize:this.pageSize,pageNo:this.pageIndex},orderDTOs:[]},this.queryModel));n.then(function(e){"1"==e.code?(this.queryResult=e.data.records,this.totalPages=e.data.pageDTO.totalCount):this.popAlert(e.message,"error")}.bind(this))}.bind(this),this.reportExport=function(){var e="";e=1==this.displayMethod?ApiDefines.CHANNEL_MARKET_EFFECT_TIME_VIEW_EXPORT:ApiDefines.CHANNEL_MARKET_EFFECT_MEDIA_VIEW_EXPORT;var t=s.post(e,angular.extend(this.queryModel));t.then(function(e){"1"==e.code?window.open(n.get(Constants.FILE_SERVER_PATH)+ApiDefines.FILE_DOWN+"?downFileName="+e.data.downFileName):this.popAlert(e.message,"error")}.bind(this))}.bind(this)}CheckLoginContext.extend(ContextSupport),HomeContext.extend(ContextSupport),IndexContext.extend(ContextSupport),MainContext.extend(ContextSupport),RoleSelectContext.extend(ContextSupport),ConfigManagementContext.extend(ContextSupport),CreateConfigContext.extend(ContextSupport),EditeConfigContext.extend(ContextSupport),ActivityEncourageAddContext.extend(ContextSupport),ActivityEncourageAuditContext.extend(ContextSupport),ActivityEncourageListContext.extend(ContextSupport),ActivityEncourageUpdateContext.extend(ContextSupport),ActivityEncourageViewContext.extend(ContextSupport),AddProductContext.extend(ContextSupport),CPSProductListContext.extend(ContextSupport),CPSTypeActivityEncourageAddContext.extend(ContextSupport),CPSTypeActivityEncourageUpdateContext.extend(ContextSupport),CPSTypeAddContext.extend(ContextSupport),CPSTypeDetailContext.extend(ContextSupport),CPSTypeEncourageAuditContext.extend(ContextSupport),CPSTypeListContext.extend(ContextSupport),CPSTypeUpdateContext.extend(ContextSupport),ProductBrandContext.extend(ContextSupport),ProductCPSContext.extend(ContextSupport),ProductTypeContext.extend(ContextSupport),AccountQueryContext.extend(ContextSupport),ApplyPurchaseContext.extend(ContextSupport),ConfigItemContext.extend(ContextSupport),MemberBillQueryContext.extend(ContextSupport),MemberDailySummaryContext.extend(ContextSupport),MemberSetlementDetailContext.extend(ContextSupport),SubmitBusinessAuditContext.extend(ContextSupport),MediaAuditContext.extend(ContextSupport),MediaAuditInfoContext.extend(ContextSupport),MediaBlackListContext.extend(ContextSupport),MediaInfoContext.extend(ContextSupport),MediaListContext.extend(ContextSupport),MemberAuditContext.extend(ContextSupport),MemberAuditInfoContext.extend(ContextSupport),MemberDetailContext.extend(ContextSupport),MemberInfoContext.extend(ContextSupport),MemberListContext.extend(ContextSupport),MemberMessageListContext.extend(ContextSupport),MessageCreateContext.extend(ContextSupport),MessageDetailContext.extend(ContextSupport),MessageEditContext.extend(ContextSupport),MessageListContext.extend(ContextSupport),MessageViewContext.extend(ContextSupport),ViewPictureContext.extend(ContextSupport),AdditionalOrderSettleContext.extend(ContextSupport),CPSOrderListContext.extend(ContextSupport),ExceptionOrderImportContext.extend(ContextSupport),EditTemplateContext.extend(ContextSupport),HelpCenterAddContext.extend(ContextSupport),HelpCenterListContext.extend(ContextSupport),HelpCenterUpdateContext.extend(ContextSupport),NoticeApproveContext.extend(ContextSupport),NoticeCreateContext.extend(ContextSupport),NoticeUpdateContext.extend(ContextSupport),NotificationListContext.extend(ContextSupport),TemplateListContext.extend(ContextSupport),AdActivitiesAddContext.extend(ContextSupport),AdActivitiesAuditContext.extend(ContextSupport),AdActivitiesListContext.extend(ContextSupport),AdActivitiesUpdateContext.extend(ContextSupport),AdActivitiesViewContext.extend(ContextSupport),PromotionDetailReportContext.extend(ContextSupport),PromotionEffectReportContext.extend(ContextSupport);